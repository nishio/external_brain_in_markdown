---
title: "pIntEn 組版開始"
---

from [[エンジニアの知的生産術英語化プロジェクト(-20190522)]]
pIntEn 組版開始
2019-02-01
- 1ヶ月分の進捗=75ページ
- 翻訳だけに限れば3月中には終わるペース
- ただし「電子書籍リリース」のための作業の工数は見積れていない
- 今翻訳中の章が終わったタイミングでそこまでの分冊を作って計測する予定

2019-02-04
- 3日: 2章までの翻訳が終わった
    - 「[[キリのいいところで終わらない]]」ために3章に入っておいた
- 予定では2章が終わったら分冊作成に入ることになってた
    - 2章までの翻訳が終わったので予定では電子書籍化をして時間を計測することになってるのだけど、だいぶ定型タスクの繰り返しに落ちてきた「翻訳」というプロセスと何をやったらいいかが不明瞭な「電子書籍化」というタスクが混ざるとなんかアレだなぁ、という気持ち（何）
    - 今日はせっかくフルに時間を使えるので定型タスクの翻訳を引き続きやってて、明日は会議とか夜やる実験とかで時間が寸断されるから、隙間時間で電子化に挑戦、という感じを考えているが「やること」が不明瞭なタスクを隙間時間でやるのができるのかどうか若干怪しい。
- →
    - 考えてみた
    - 今、翻訳は「日単位」でログを取り、ポモドーロ単位で作業をしている
    - 組版作業はあえて細切れ時間で実行するのはどうか
    - 塊の時間は翻訳に当て、細切れ時間で体裁を整える
    - 執筆に疲れた状態で息抜きに組版する
    - 翻訳と組版でリソースを奪い合って「どちらをやろう」でやる気が失われる事態は避けたい
    - 基本的に1ポモドーロの時間があるなら翻訳の側を進める

- 作業メモ
    - Dropbox:/intellitech-howtoboostyourcreativityに原稿がある
    - 画像はimagesに入れた
    - [[Typora]]を起動する（これにしか使ってないのでRecentで見れる)
    - オンライン時
        - Scrapboxの各ページをたどってmarkdown化してTyporaに貼っていく
    - オフライン時
        - Typoraに貼られたものを直していく

- Author→Books→タイトル→Preview→Create Preview
    - パーマリンクあった [https://leanpub.com/intellitech-howtoboostyourcreativity/preview](https://leanpub.com/intellitech-howtoboostyourcreativity/preview)

2019-02-08
- ドラッグドロップした画像はフルパスになっている
    - 正しくは`images/tmp.png`みたいにしなければならない
- 脚注は `[^1]`と`[^1]:`でTypola上は認識されてプレビューもできるのだが、LeanPubではうまく動かない
- 現状の設計
    - 日本語版の章立ては、章番号、節番号などの組み合わせで表現
    - 追加された節などは法律の条文と同じように枝番号がつく
    - コラムは章とは紐付けない
    - ページ中のキーワードのリンクは、書籍で言うところの「索引」に相当するものなので、xxxってリンクはコンテンツの末尾にxxxの項目があってそこにジャンプし、その項目にxxxの出現箇所全てへのリンクが置かれている形
    - この仕様で実装したけど、そうすると「どこにも繋がってないリンク」も普通のリンクに見えて、クリックしても一項目だけかかれた索引に飛んで、嬉しくない。Scrapboxの場合リンクが赤リンク青リンクと別れることで、繋がってないリンクは踏まなくても繋がってないのがわかる。電子書籍の場合は繋がってないリンクはただのキーワード表示とかになるべきか。いまワンバスで処理してるけどツーパスが必要になるな。
    - Markuaが英数ハイフンぐらいしかIDに許容してないので、md5ハッシュの冒頭7文字をIDにしてる

2019-02-11
- daiizさんがScrapbox→Re:VIEW→電子書籍、を試している
    - [土曜日 - #daiizメモ](https://daiiz.hatenablog.com/entry/2019/02/09/235500)
    - [/daiiz/sb2re 開発帳](https://scrapbox.io/daiiz/sb2re 開発帳)
- 僕はScrapbox→[[LeanPub]] Markdown→電子書籍、の流れ

2019-02-14
- プロジェクトを作った段階でティザーサイトができてる
    - [https://leanpub.com/intellitech-howtoboostyourcreativity](https://leanpub.com/intellitech-howtoboostyourcreativity)
    - ![image](https://gyazo.com/a1332e760a88e50e3e7c4002771f1566/thumb/1000)
- 完成度を表示できるので10%にしておいた
    - 1章完成するごとに10%増やすと全部終わった時に80%だから、そこから全体の見直しをしよう
- こまめにリリースすることが推奨されているのでリリースボタンを押してみた
- 最低金額は4.99$より下げられない
- ![image](https://gyazo.com/33fd428ec32ca6bbd260ba1f89902ef4/thumb/1000)
- ページ数と単語数を表示するようにした。自動でカウントされて表示される。30ページ、3645単語。
- 金額のスクロールバーは何かと思ったらドラッグしていくら払うかを決められる
    - 最大25$まであげられたけど、これは僕がどこかで上限の設定をしているのかな
- ほほう、クリエイティブ・コモンズにするという選択肢もあるのか
    - ![image](https://gyazo.com/2c8b29bf5794f77948e0eb260bb141d2/thumb/1000)
- ForumをEnableできた
    - [https://community.leanpub.com/c/intellitech-how](https://community.leanpub.com/c/intellitech-how)

- 作業
    - 脚注がTypola上では正しく表示されていたがepubでは壊れた問題
        - Markuaの脚注定義は直前に空行を必要とする
        - epubだと書籍末にまとめられてしまった。個人的には「読まなくても目に入る」が脚注の良さなので好きでないが、優先度は低いか
    - PDF版で日本語が化ける問題
        - とりあえず日本語を全部{japanesefont}{latinfont}で囲めば良い
        - スクリプトで自動化しようと思ったが
        - `[{japanesefont}日本語{latinfont}](...)`
        - とか面倒だな
    - とりあえず手で直した。
    - 英語の部分もまとめて日本語にしてみたら、フォントがダサかった。
    - これはアウトソースすることを考えた方が良いかもなぁ。

- Typola上では図altはaltに過ぎないが、Markuaでは図キャプションである
    - Typola上でキャプションが出なくてギョッとした
        - 正しいマークアップを習得するまでのイテレーションが長いよ

- バグで1行に複数のリンクがある場合にリンクの間の文章が消えていた
    - [[バグった出力を元に作業した場合のリカバリ]]

- とりあえずここまでの修正作業を踏まえて新しいバージョン2をリリースしてみた。
    - 新しいバージョンをリリースすると読者に通知が行くらしい。
    - 執筆中のレビューとかこれでやったらよかったのでは。
    - ![image](https://gyazo.com/311dee8055e2f649a7e2528f093a8321/thumb/1000)

- 無料で配る方法がないわけないよなって思ったら「クーポン」っていうのか
    - ![image](https://gyazo.com/c2bfb96f203a6a91defbb5577c8b58e8/thumb/1000)
    - なおこの状態でcreateして4.99ドルを4.99ドルに値引き？するクーポンになってしまったw
    - 編集できるので安心
- リンクをもらった人はこんな感じで割引価格で入手できる。0ドルに割り引いた。
    - ![image](https://gyazo.com/689fc199ad13e47cf2131b9b18494852/thumb/1000)

- 買った本はこんな感じでライブラリに入る
    - ![image](https://gyazo.com/cb5843c296d42db833ef00d2bdbeac4e/thumb/1000)

- Scrapbox上に連絡先などを書いてたが、そもそもLeanPub上にこんな感じで出てる
    - ![image](https://gyazo.com/8807266e7015c798bb7c1d657c56aeac/thumb/1000)

- 自分のライブラリの本を見るとこんな感じ
    - ![image](https://gyazo.com/d0938b60646a9698299435cafd540911/thumb/1000)
    - あ、更新のメール通知ってデフォルトはオフなのか

- Scrapboxのパーサー、どっちみち今年後半のプロジェクトでも必要になるのだから自分で作った方が良いのではという気がしてきた。リンクと箇条書きと画像と外部リンクくらいで僕の用途には十分だし。
    - 雑に[[Scrapboxパーサ]]を作った

- ページ一覧からツリーを作る
    - 今回はページ一覧をアルファベット順にソートしたものを得て、手作業でツリーにする
    - 書籍由来のプロジェクトなので、章番号がタイトルについているため
    - 普通のプロジェクトだとどう並べていいか
        - 人間に丸投げする案
        - 何らかのサジェストをする案

- ScrapboxのAPI叩いて複数ページの内容を取得して繋げてmarkdownにするところまでできた。書籍のクロスリンク用のidを埋めるところまでやるかどうか少し悩んだけど、それは将来的に2パスになる予定だしScrapboxには全然関係ないから分かれてた方がいいなと今は思っている

![image](https://gyazo.com/072bdf330761fbf37fcb5c78488ee526/thumb/1000)

- 一部の画像がScrapboxにしかない(Gyazoにある)
    - Scrapboxをクロールする際に自動的にダウンロードするか
    - 画像がアップデートされたり追加されたりすることも考えるとそれがスムーズか
    - 今回ローカルに事前に画像があるのは割と特殊なユースケース


2019-02-19
- ScrapboxのAPIでダウンロードしたJSONファイルから、画像(Gyazo)へのリンクを発見して、全部ローカルに保存するスクリプトを実装した
- 当初の予想と違って「電子書籍作成作業」は単調作業ではなくてむしろプログラミングに近い作業だった。
- 「こうすればこう出力されるだろう」「されなかったぞ、何がいけないんだ」と言うデバッグのプロセスがある。

- 書籍丸一章分をtypolaでプレビューしてるとコードモードとプレビューモードを切り替えた時に謎の場所ズレが起きて使い物にならないので、Scrapboxの1ページを1ファイルで吐いて置いて短い単位で扱う方が良いのかも
    - と思ったがページタイトルをファイル名としてvalidな文字列に自動で変換するの面倒だな
