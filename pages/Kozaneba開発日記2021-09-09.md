
prev [[Kozaneba開発日記2021-09-08]]
![image](https://gyazo.com/cef794096b06743c1bbd9b9c4b40f0c4/thumb/1000)

---
昨日はJSONを読み込んでソースコードの可視化ができた
- ユーザが同じことを試みた時に正しくないフォーマットのJSONを入れてエラーが出たらSentryを見て僕が混乱するので、インポート時に正しいフォーマットなのか確認すべき
- 正しくないとき、エラーを僕に送るのではなくユーザにフィードバックすべき

矢印機能
- GUIでつける手段がない
- GUIでつける矢印はクリックできて欲しい？
    - そのためには今のは細すぎる
    - しかしソースコードの可視化の際には細いのがよかった
    - Ba単位で切り替えられる必要がある

物理演算
- APIをコンソールから叩けばオンオフできる
- ユーザスクリプトでボタンをつける

ユーザスクリプト編集画面欲しい
- これを実行してエラーになった時もSentryに送るのではなくユーザにフィードバックするべき

---
インポートのエラーフィードバック、できた

昨日のリリースノート書いてなかったな
- `Annotation Layer`が追加された
    - 現在は矢印だけ実装されている
    - GUIはまだ作っていない、JSONのインポートでのみ作成できる
- 物理演算による自動整形機能が追加された


次はユーザスクリプト編集画面
- done
- ユーザスクリプトで物理演算ボタンをつける

![image](https://gyazo.com/d493d53577b82f002ebac352258d2925/thumb/1000)

![image](https://gyazo.com/679775b480aa540d3a095a97287a9792/thumb/1000)
![image](https://gyazo.com/8f571f642b87f4a20ae59fa5f7f0207a/thumb/1000)
![image](https://gyazo.com/6f34662f37f13b9ade7b6fd8b1d0ed51/thumb/1000)

> 　GUIでつける矢印はクリックできて欲しい？
>  　　そのためには今のは細すぎる
>  　　しかしソースコードの可視化の際には細いのがよかった
>  　　Ba単位で切り替えられる必要がある
これは誤り
- プログラムで700本生成する矢印と人間が手でつける矢印は別物
- 生成する矢印の方が軽量なデータであるべき
- ユーザが作る方にカスタムスタイルをつければ良い

![image](https://gyazo.com/8c1ce3bb6927e704966910f4aaa240b0/thumb/1000)

リリースノート
- UserScriptダイアログを追加し、現在のコードを確認し、書き換え、実行し、保存できるようになった
    - 今までUserScriptはlocalStorageを直接書き換える方法しかなかった
- 選択メニューから矢印の追加ができるようになった
    - ![image](https://gyazo.com/cef794096b06743c1bbd9b9c4b40f0c4/thumb/1000)

削除はまだないが、必要かどうかしばらく運用してから考えよう
矢印のスタイルを事後的に変えたいときは矢印をクリックするつもりだったが、矢印の頭がついてない側に頭をつけたい時に「頭のついてないところ」をクリックする必要があってなかなか使いやすいのか微妙な気がしてきた

Kozanebaにチュートリアル以外にもヘルプをつけようと思ってたんだけど、フォーラムに書いてリンクを示せばいいのではって気持ちになってきた
- 例えばこざね追加ダイアログに現状の「1行1こざね」のほかにScrapboxフォーマットとMarkdownフォーマットの読み込みをつけたとして、そこにヘルプアイコンを置いたとして、これをアプリ内でヘルプダイアログで開くと元のダイアログは閉じてしまう
- チュートリアルは「画面サイズを検知して小さすぎると警告」とか「操作を試すためのプリセットを用意する」とか割と色々するのでプログラムと一体であることにメリットがあったが、追加コンテンツに関してはそうでもない気がする…

明日はKeichoの改善をして、KeichoもKozanebaでのプロジェクト管理に移行する

KozanebaからのCopy as Textはグループをインデントで保とうとしたりとかはせず、別途Copy as ScrapboxとCopy as Markdownをつけることを考えている…
まあ明日はKeichoの方をやるのでアイデアだけ練っておいてやるとしても来週。機能追加ばかりしすぎという説もあるので、あえて機能追加しない縛りの週を作るかもしれない