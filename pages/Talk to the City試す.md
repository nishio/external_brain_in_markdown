---
title: "Talk to the Cityè©¦ã™"
---

> [nishio](https://x.com/nishio/status/1796156174250734034) æ–‡åŒ–åºãŒåé›†ã—ãŸ[[AIã¨è‘—ä½œæ¨©ã«é–¢ã™ã‚‹ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆ]]ã‚’AI(Talk to the City)ã§åˆ†æå¯è¦–åŒ–ã—ã¾ã—ãŸ
>  ![image](https://gyazo.com/513b9a5424f8f2b112bd9305ed5677dd/thumb/1000)
> [nishio](https://x.com/nishio/status/1796156300189208780) å³ä¸Šã®å›½æ——ã‚¢ã‚¤ã‚³ãƒ³ã§æ—¥æœ¬èªã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™
>  [https://nishio.github.io/tttc_aipubcom_japan/](https://nishio.github.io/tttc_aipubcom_japan/)



å®Ÿé¨“ãƒ—ãƒ­ã‚»ã‚¹
---

[[Talk to the City]]
[/tkgshn/å°æ¹¾ã®åŒæ€§å©šã«é–¢ã™ã‚‹è­°è«–ã‚’Talk to the Cityã§ãƒ¬ãƒãƒ¼ãƒˆåŒ–ã—ã¦ã¿ã‚‹](https://scrapbox.io/tkgshn/å°æ¹¾ã®åŒæ€§å©šã«é–¢ã™ã‚‹è­°è«–ã‚’Talk to the Cityã§ãƒ¬ãƒãƒ¼ãƒˆåŒ–ã—ã¦ã¿ã‚‹)

2024-05-27
- 2024-05-26ã«[[Talk to the Cityã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°]]ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒæ°—ã«ãªã£ãŸã®ã§èª¿ã¹ãŸ #éƒ½çŸ¥äº‹é¸xãƒ‡ã‚¸ã‚¿ãƒ«æ°‘ä¸»ä¸»ç¾©
- [https://github.com/AIObjectives/talk-to-the-city-reports.git](https://github.com/AIObjectives/talk-to-the-city-reports.git)
- ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ„ãƒ¼ãƒ«ã®"[[Talk to the City Turbo]]"ã®ä½¿ç”¨ã«tkgshnãŒè‹¦åŠ´ã—ã¦ãŸãŒã€CLIã®ãƒ„ãƒ¼ãƒ«"[[Talk to the City Reports]]"ã‚‚ã‚ã‚‹ã¿ãŸã„ãªã®ã§ã“ã‚Œã‚’ã¿ã¦ã¿ã‚ˆã†
- ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ä¸€æœ¬é“

è©¦ã™ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨ã™ã‚‹
- [[AIã¨è‘—ä½œæ¨©ã«é–¢ã™ã‚‹ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆ]]
    - å‰²ã¨ã‚´ãƒŸã‚´ãƒŸã—ã¦ã‚‹ãª...

å…ˆã«åˆ¥ä»¶ã§[[æ±äº¬å¤§å­¦è°·å£ç ”ç©¶å®¤ãƒ»æœæ—¥æ–°èç¤¾å…±åŒèª¿æŸ»]](UTAS)ã®Polisçš„åˆ†æã‚’ã‚„ã‚‹
- Polisçš„ãƒ‡ãƒ¼ã‚¿ã¨è‡ªç„¶æ–‡ã®ä¸¡æ–¹ãŒã‚ã‚‹
    - è‡ªç„¶æ–‡ã¯å°‘ãªã„
    - ã¾ãšã¯Polisçš„åˆ†æã‚’ã—ãŸ âœ…[[pPolis2024-05-27]]

2024-05-30
UTASãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è‡ªç„¶æ–‡ã‚’æŠœãå‡ºã™
- [https://gist.github.com/nishio/de629941b5ac4a080fae88348df1499c](https://gist.github.com/nishio/de629941b5ac4a080fae88348df1499c)
    - æ†²æ³•æ”¹æ­£ã«ã¤ã„ã¦ã®126äººã®æ”¿æ²»å®¶ã®ã‚³ãƒ¡ãƒ³ãƒˆ
        - é‡è¤‡ã‚‚å¤šã„
        - é‡è¤‡ã‚’é™¤ãã¨85ä»¶
    - å‚è­°é™¢ã«é–¢ã—ã¦ã®ã‚³ãƒ¡ãƒ³ãƒˆã ã¨ã‚‚ã£ã¨å¤šã„

ã¨ã‚Šã‚ãˆãšå°ã•ã„ã‚‚ã®ã§è©¦ã™ã‹ã€‚[[ã‚¹ãƒ¢ãƒ¼ãƒ«ã‚¹ã‚¿ãƒ¼ãƒˆ]]
READMEã«å¾“ã£ã¦comment-idã¨comment-bodyã‚’ã‚‚ã£ãŸCSVã¨configã‚’ä½œã‚Šå®Ÿè¡Œã™ã‚‹

# extraction
extraction

```
Running step: extraction
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                      | 2/4 [00:05<00:05,  2.92s/it]JSON error: Expecting value: line 1 column 1 (char 0)
Input was: å¤–å›½å‹¢åŠ›ã®é€²è¡Œã«å¯¾ã™ã‚‹å³ç½°
Response was: I'm sorry, but I can only assist in English. If you provide the text in English, I'll be happy to help you refine it.
Retrying...
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                           | 3/4 [00:07<00:02,  2.51s/it]JSON error: Expecting value: line 1 column 1 (char 0)
Input was: çµ±æ²»æ©Ÿæ§‹æ”¹é©
Response was: I'm sorry, but it seems like the text "çµ±æ²»æ©Ÿæ§‹æ”¹é©" is in a language that I am not able to understand. Could you please provide the text in English so that I can assist you with making it more concise and easy to read?
Retrying...
JSON error: Expecting value: line 1 column 1 (char 0)
Input was: çµ±æ²»æ©Ÿæ§‹æ”¹é©
Response was: I'm sorry, but it seems like the text "çµ±æ²»æ©Ÿæ§‹æ”¹é©" is in a language other than English, and I am unable to provide a concise and clear argument based on it. If you could provide a translation or more context, I would be happy to assist further.
Retrying...
JSON error: Expecting value: line 1 column 1 (char 0)
Input was: çµ±æ²»æ©Ÿæ§‹æ”¹é©
Response was: I'm sorry, but it seems like the text you provided is not related to the topic of artificial intelligence. Could you please provide an argument related to AI for me to help you refine?
Retrying...
JSON error: Expecting value: line 1 column 1 (char 0)
Input was: çµ±æ²»æ©Ÿæ§‹æ”¹é©
Response was: I'm sorry, but it seems like the text "çµ±æ²»æ©Ÿæ§‹æ”¹é©" is in a language other than English. Could you please provide a translation or more context so I can assist you better?
Silently giving up on trying to generate valid list.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.23s/it]
```


æ—¥æœ¬èªã‹ã‚‰ã®è§£é‡ˆã«æˆ¸æƒ‘ã£ã¦ã‚‹
ä½•å›ã‹ãƒªãƒˆãƒ©ã‚¤ã—ã¦ãƒ€ãƒ¡ã ã£ãŸã‚‰è«¦ã‚ã‚‹ã®ã‹ "Silently giving up on trying to generate valid list."
ã¨ã¯ã„ãˆä»–ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚‚æ—¥æœ¬èªã ã‘ã©ã™ã‚“ãªã‚Šè§£é‡ˆã•ã‚Œã¦ã‚‹ã®ã§ã€çŸ­ã™ããŸã‚Šæ›–æ˜§ã ã£ãŸã‚Šã—ã¦æ„å‘³ã®æŠ½å‡ºã«å¤±æ•—ã—ã¦ã‚‹ã£ã¦ã“ã¨ãªã‚“ã ãªã€‚
- ğŸ¤–ã€Œ"çµ±æ²»æ©Ÿæ§‹æ”¹é©"ã£ã¦ã€ã©ã†ã„ã†æ„å‘³ãªã®ã‹ã‚ˆãã‚ã‹ã‚“ãªã„ãªãã€œã€

# embedding
embedding

```
Running step: embedding
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:10<00:00, 10.26s/it]
```


# clustering
:

```
Running step: clustering
Traceback (most recent call last):
  File "/Users/nishio/talk-to-the-city-reports/scatter/venv/lib/python3.12/site-packages/nltk/corpus/util.py", line 84, in __load
    root = nltk.data.find(f"{self.subdir}/{zip_name}")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nishio/talk-to-the-city-reports/scatter/venv/lib/python3.12/site-packages/nltk/data.py", line 583, in find
    raise LookupError(resource_not_found)
LookupError: 
**********************************************************************
  Resource stopwords not found.
  Please use the NLTK Downloader to obtain the resource:

  >>> import nltk
  >>> nltk.download('stopwords')
```


ã„ã‚„ã„ã‚„ãƒ€ãƒ¡ã ã‚ã“ã‚Œw
clustering.py

```
   stop = stopwords.words("english")
   vectorizer_model = CountVectorizer(stop_words=stop)
```


è¨€èªãŒè‹±èªã§ã‚ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã‚‹ã˜ã‚ƒã‚“
ã¾ã‚ã„ã„ã‹ã€ã¾ãšã¯æœ€å¾Œã¾ã§é€²ã‚“ã§å…¨ä½“åƒã‚’æŠŠæ¡ã™ã‚‹ã‹

:

```
Running step: clustering
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
2024-05-30 14:43:23,417 - BERTopic - Reduced dimensionality
2024-05-30 14:43:23,423 - BERTopic - Clustered reduced embeddings
```


# labelling, takeaways, overview
:

```
Running step: labelling
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:02<00:00,  1.20it/s]
Running step: takeaways
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:04<00:00,  1.67s/it]
Running step: overview
```


# translation
:

```
Running step: translation
Translating to Mandarin...
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:16<00:00,  2.38s/it]
Translating to English...
  0%|                                                                                                                    | 0/7 [00:00<?, ?it/s]JSON error: Expecting ',' delimiter: line 1 column 216 (char 215)
Response was: ["Through public debate, considering Japan's history and education, it is necessary to create a democratic law by taking time into account.", "It is important to reflect the public opinion by creating a process of "constitutional amendment" through consensus.", "It is necessary to stop the annual budget system.", "For the protection of human rights, it is essential to have discussions and collaborations on the internet.", "Through public debate, considering Japan's history and education, it is necessary to create a democratic law by taking time into account.", "By passing the process of "constitutional amendment", reflecting the public opinion is important.", "For Japan to consider Japan's future, it is necessary to establish a law that will become the basis.", "By revising the 41st article of the constitution, implementing the national referendum, and reflecting its contents in politics is important.", "Keep an eye on the "constitutional amendment".", "Revise the 41st law, implement the national referendum, and reflect its contents in politics."]
Retrying batch...
Warning: batch size mismatch!
Batch len: 10
Response len: 9
Batch item 0: å›½æ°‘ã®è­°è«–ã‚’é€šã˜ã¦ã€æ—¥æœ¬ã®ä¼çµ±ã‚„ç¿’æ…£ã‚’è€ƒæ…®ã—ãŸè‡ªä¸»æ†²æ³•ã‚’æ™‚é–“ã‚’ã‹ã‘ã¦ä½œã‚‹ã¹ã
Response: By engaging in public debate, considering Japan's history and education, creating necessary self-defense laws over time is essential
Batch item 1: ã€Œå‰µæ†²ã€ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’é€šã˜ã¦å›½æ°‘ã®æ„è¦‹ã‚’åæ˜ ã•ã›ã‚‹ã¹ã
Response: By promoting the principles of 'innovation', reflecting the opinions of the people to be considered
Batch item 2: å»ƒæ­¢ã™ã¹ãäºˆç®—ã®å˜å¹´åº¦åˆ¶åº¦
Response: It is necessary to stop the annual budget system
Batch item 3: äººæ¨©ä¿è­·ã®ãŸã‚ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã§ã®å–ã‚Šçµ„ã¿ãŒå¿…è¦
Response: For the protection of human rights, it is essential to have an internet platform for gathering information
Batch item 4: å›½æ°‘ã®è­°è«–ã‚’é€šã˜ã¦æ—¥æœ¬ã®ä¼çµ±ã‚„ç¿’æ…£ã‚’è€ƒæ…®ã—ãŸè‡ªä¸»æ†²æ³•ã‚’æ™‚é–“ã‚’ã‹ã‘ã¦ä½œã‚‹ã¹ã
Response: By engaging in public debate, considering Japan's history and education, creating necessary self-defense laws over time is essential
Batch item 5: ã€å‰µæ†²ã€ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’é€šã˜ã¦å›½æ°‘ã®æ„è¦‹ã‚’åæ˜ ã•ã›ã‚‹ã¹ã
Response: Establishing laws to become a better future for Japan that the Japanese people consider
Batch item 6: æ—¥æœ¬å›½æ°‘ãŒè€ƒãˆã‚‹æ—¥æœ¬ã®å°†æ¥ã®ãŸã‚ã«ãªã‚‹æ†²æ³•ã‚’å‰µè¨­ã™ã¹ãã ã€‚
Response: By revisiting discussions and debates, developing Japan's unique education and history, creating necessary self-defense laws over time
Batch item 7: å›½æ°‘ã¨è­°è«–ã‚’é‡ã­ãªãŒã‚‰ã€æ—¥æœ¬ç‹¬è‡ªã®ç¿’æ…£ã‚„ä¼çµ±ã‚’é‘‘ã¿ãŸè‡ªä¸»æ†²æ³•ã‚’æ™‚é–“ã‚’ã‹ã‘ã¦ä½œã‚‹ã€‚
Response: Keep the focus on 'innovation'
Batch item 8: ã€Œå‰µæ†²ã€ã‚’ç›®æŒ‡ã™ã€‚
Response: Amend the 41st law, implement national referendums on important legislation, and reflect its contents in politics
Batch item 9: æ†²æ³•ç¬¬å››åä¸€æ¡ã‚’æ”¹æ­£ã—ã¦ã€é‡è¦æ³•æ¡ˆã«ã¤ã„ã¦å›½æ°‘æŠ•ç¥¨ã‚’å®Ÿæ–½ã—ã€ãã®å†…å®¹ã‚’æ”¿æ²»ã«åæ˜ ã•ã›ã‚‹ã¹ãã€‚
Retrying with smaller batches...
```

ã¾ã¨ã‚ã¦ç¿»è¨³ã—ã‚ˆã†ã¨ã—ã¦å¤±æ•—ã—ã¦ã‚‹
- ä½•åº¦ã‹ã‚„ã‚Šç›´ã—ã¦ãŸ
- çµæœçš„ã«ç¿»è¨³ã¯ã§ããŸã£ã½ã„

# visualization
:

```
Running step: aggregation
Running step: visualization
> next-app@0.1.0 build
> next build
```


é™çš„HTMLãŒå‡ºåŠ›ã•ã‚Œã‚‹

![image](https://gyazo.com/cd28455301f8f4eb3c034e1b7bf4cf36/thumb/1000)
ã‚¿ã‚¤ãƒˆãƒ«ã¯configã‹ã©ã“ã‹ã§è¨­å®šã™ã¹ãã ã£ãŸãª

> Overview:
>  The public consultation on constitutional development in Japan revealed three main clusters of opinions. Cluster 0 emphasized the importance of crafting a unique constitution reflecting Japanese traditions, while Cluster 1 focused on constitutional reform through public engagement and utilizing the internet for human rights protection. Cluster 2 highlighted the need for a new constitution with amendments to include national referendums and strengthen the role of the National Diet, along with calls for strict penalties against foreign interventions.
<img src='https://scrapbox.io/api/pages/nishio/gpt/icon' alt='gpt.icon' height="19.5"/>æ¦‚è¦:
æ—¥æœ¬ã«ãŠã‘ã‚‹æ†²æ³•æ”¹æ­£ã«é–¢ã™ã‚‹å…¬é–‹å”è­°ã§ã¯ã€3ã¤ã®ä¸»è¦ãªæ„è¦‹ã®ã‚°ãƒ«ãƒ¼ãƒ—ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸã€‚ã‚¯ãƒ©ã‚¹ã‚¿0ã¯ã€æ—¥æœ¬ã®ä¼çµ±ã‚’åæ˜ ã—ãŸç‹¬è‡ªã®æ†²æ³•ã®ä½œæˆã®é‡è¦æ€§ã‚’å¼·èª¿ã—ã€ã‚¯ãƒ©ã‚¹ã‚¿1ã¯ã€æ†²æ³•æ”¹é©ã‚’å…¬è¡†ã®å‚åŠ ã‚’é€šã˜ã¦è¡Œã„ã€äººæ¨©ä¿è­·ã®ãŸã‚ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã—ãŸã€‚ã‚¯ãƒ©ã‚¹ã‚¿2ã¯ã€å›½æ°‘æŠ•ç¥¨ã‚’å«ã‚€æ”¹æ­£ã‚„å›½ä¼šã®å½¹å‰²ã‚’å¼·åŒ–ã™ã‚‹æ–°ã—ã„æ†²æ³•ã®å¿…è¦æ€§ã‚’å¼·èª¿ã—ã€å¤–å›½ã‹ã‚‰ã®å¹²æ¸‰ã«å¯¾ã™ã‚‹å³ã—ã„ç½°å‰‡ã‚’æ±‚ã‚ã¾ã—ãŸã€‚

![image](https://gyazo.com/44f207f7dba5759da45359d4026c1481/thumb/1000)

ãƒ›ãƒãƒ¼ã™ã‚‹ã¨ã“ã†ãªã‚‹
![image](https://gyazo.com/b4edf6bd8b0ac7ad8c90b4dc959f0bb3/thumb/1000)
ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã“ã†ãªã‚‹
![image](https://gyazo.com/daa59e7c46e449879ef4b650b030aeb0/thumb/1000)

ã“ã‚Œã‚’ã“ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«å…¥ã‚Œã‚‹ã‹
![image](https://gyazo.com/b4c0ca19fdd29845366f5e3a00908ed6/thumb/1000)

![image](https://gyazo.com/2d99689ba283be2603326428a2922153/thumb/1000)
ç¿»è¨³å¤±æ•—ã—ã¦ã‚‹

> Representative comments:
>  å›½æ°‘ã®è­°è«–ã‚’é€šã˜ã¦ã€æ—¥æœ¬ã®ä¼çµ±ã‚„ç¿’æ…£ã‚’è€ƒæ…®ã—ãŸè‡ªä¸»æ†²æ³•ã‚’æ™‚é–“ã‚’ã‹ã‘ã¦ä½œã‚‹ã¹ã
>  å›½æ°‘ã®è­°è«–ã‚’é€šã˜ã¦æ—¥æœ¬ã®ä¼çµ±ã‚„ç¿’æ…£ã‚’è€ƒæ…®ã—ãŸè‡ªä¸»æ†²æ³•ã‚’æ™‚é–“ã‚’ã‹ã‘ã¦ä½œã‚‹ã¹ã
>  å›½æ°‘ã¨è­°è«–ã‚’é‡ã­ãªãŒã‚‰ã€æ—¥æœ¬ç‹¬è‡ªã®ç¿’æ…£ã‚„ä¼çµ±ã‚’é‘‘ã¿ãŸè‡ªä¸»æ†²æ³•ã‚’æ™‚é–“ã‚’ã‹ã‘ã¦ä½œã‚‹ã€‚
>  å›½æ°‘ã®è­°è«–ã‚’é€šã˜ã¦ã€æ—¥æœ¬ã®ä¼çµ±ã‚„ç¿’æ…£ã‚’è€ƒæ…®ã—ãŸè‡ªä¸»æ†²æ³•ã‚’æ™‚é–“ã‚’ã‹ã‘ã¦ä½œæˆã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
>  å»ƒæ­¢ã™ã¹ãäºˆç®—ã®å˜å¹´åº¦åˆ¶åº¦
- ã“ã‚Œã‚’ã“ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«å…¥ã‚Œã‚‹ã‹

![image](https://gyazo.com/39cbb634818132cf5507627f6b9c0f5e/thumb/1000)

# Appendix
![image](https://gyazo.com/9d91ba4647492bdea0946b1d67a586bb/thumb/1000)
ã“ã‚Œã¯æœ‰ç”¨ã ãª
- é€”ä¸­çµŒéãƒ‡ãƒ¼ã‚¿ã‚‚ã‚ã‚‹ã¨ã„ã„ã®ã«

AIã‚³ã‚¹ãƒˆ
![image](https://gyazo.com/c0e35ea852610126fe5e9d8a1bfbb20e/thumb/1000)

ãƒ‡ãƒ¼ã‚¿é‡
- æ—¥æœ¬èª2450æ–‡å­—

å¤§ããªãƒ‡ãƒ¼ã‚¿ã§è©¦ã™å‰ã«ã‚‚ã†ã™ã“ã—è‰²ã€…è©¦ã™ã‹
configã‚’å†æ¤œè¨
json

```json
{
  "name": "Recursive Public, Agenda Setting",
  "question": "What should be top of the agenda as humanity develops and deploys artificial intelligence?",
  "input": "UTAS_2022__SQ6_16_FA",
  "model": "gpt-3.5-turbo",
  "extraction": {
    "workers": 3,
    "limit": 12
  },
  "clustering": {
    "clusters": 3
  },
  "translation": {
    "model": "gpt-4",
    "languages": ["Mandarin", "English"],
    "flags": ["TW", "EN"]
  },
  "intro": "This AI-generated report relies on data from the UTAS 2022 (æ±äº¬å¤§å­¦è°·å£ç ”ç©¶å®¤ãƒ»æœæ—¥æ–°èç¤¾å…±åŒèª¿æŸ»)."
}
```


- > ã‚¿ã‚¤ãƒˆãƒ«ã¯configã‹ã©ã“ã‹ã§è¨­å®šã™ã¹ãã ã£ãŸãª
    - nameã¨questionãŒãã‚Œ
- ã‚¯ãƒ©ã‚¹ã‚¿3å€‹ã«å›ºå®šã—ã¦ã‚‹ã‚“ã ãª
- ç¿»è¨³ã®éƒ¨åˆ†ã€æ—¥æœ¬èªã§å‡¦ç†ã—ã¦ã‹ã‚‰è‹±èªã«ç¿»è¨³ã™ã‚‹ã¤ã‚‚ã‚Šã§ã“ã†è¨­å®šã—ãŸ
    - ã‘ã©ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ãŒè‹±èªã‚’ä»®å®šã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ã ã£ãŸã®ã§ã‚€ã—ã‚è‹±èªã§å‡¦ç†ã—ã¦æ—¥æœ¬èªã«ç¿»è¨³ã™ã‚‹æ–¹ãŒã„ã„ã‹ã‚‚
    - æ—¥æœ¬èªã®ã¾ã¾å‡¦ç†ã—ãŸã„å ´åˆã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã‚¹ãƒ†ãƒƒãƒ—ã§CountVectorizerã‚’ä½¿ã£ã¦ã‚‹éƒ¨åˆ†ã‚’æ—¥æœ¬èªã‚’æƒ³å®šã—ãŸå½¢æ…‹ç´ è§£æã¨æ—¥æœ¬èªã®ã‚¹ãƒˆãƒƒãƒ—ãƒ¯ãƒ¼ãƒ‰è¨­å®šãŒå¿…è¦ã 
    - extractionã®promptã«"All texts should be in English."ã¨è¿½åŠ ã—ã¦è‹±èªã§æŠ½å‡ºã™ã‚‹æ–¹é‡ã§é€²ã‚ã‚‹

å†å®Ÿè¡Œ
"å¤–å›½å‹¢åŠ›ã®é€²è¡Œã«å¯¾ã™ã‚‹å³ç½°"ã¨"çµ±æ²»æ©Ÿæ§‹æ”¹é©"ã¯ã¾ãŸã€Œã‚ã‹ã‚‰ã‚“ã€ã¨è¨€ã‚ã‚Œã¦ãŸ
ã‚ã€æ—¥æœ¬èªã«ç¿»è¨³ã—å¿˜ã‚ŒãŸ
:

```
So, here is what I am planning to run:
{'step': 'extraction', 'run': False, 'reason': 'nothing changed'}
{'step': 'embedding', 'run': False, 'reason': 'nothing changed'}
{'step': 'clustering', 'run': False, 'reason': 'nothing changed'}
{'step': 'labelling', 'run': False, 'reason': 'nothing changed'}
{'step': 'takeaways', 'run': False, 'reason': 'nothing changed'}
{'step': 'overview', 'run': False, 'reason': 'nothing changed'}
{'step': 'translation', 'run': True, 'reason': 'some parameters changed: languages'}
{'step': 'aggregation', 'run': True, 'reason': 'some dependent steps will re-run: translation'}
{'step': 'visualization', 'run': True, 'reason': 'some dependent steps will re-run: aggregation'}
Looks good? Press enter to continue or Ctrl+C to abort.
```

å¾ŒåŠã ã‘ã‚„ã‚Šç›´ã—ã¦ãã‚Œã‚‹

è‹±èªã‹ã‚‰æ—¥æœ¬èªã¸ã®ç¿»è¨³ã¯ç‰¹ã«å•é¡Œãªããƒãƒƒãƒå‡¦ç†ã§ãã¦ã„ãŸ
![image](https://gyazo.com/df09fdbd0383a3f2ba268babcf4f9a92/thumb/1000)
ã†ãƒ¼ã‚“ã€Œå‰µæ†²ã€ãªã‚“ã¦ç”¨èªã¯çŸ¥ã‚‰ãªã„ã‹ã‚‰èª¤è¨³ã•ã‚Œã‚‹

prompt: `All texts should be in English. Translate Japanese words based on their meaning, not just their sound.`
embeddingã§ã‚¨ãƒ©ãƒ¼
- `TypeError: expected string or buffer`
- ![image](https://gyazo.com/e14a78aa645250327a5444578f53eb8e/thumb/1000)
ã“ã‚Œã¯ã‚ã‚Œã ãª
- [FIX: LLM sometimes returns string and the code handle it as list by nishio Â· Pull Request #186 Â· AIObjectives/talk-to-the-city-reports Â· GitHub](https://github.com/AIObjectives/talk-to-the-city-reports/pull/186)

![image](https://gyazo.com/42ad2adc162133c7db85bbcf2040a56f/thumb/1000)
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åå‰ã‚’ã¤ã‘ã‚‹ã¹ãã ã£ãŸ



# [[AIã¨è‘—ä½œæ¨©ã«é–¢ã™ã‚‹ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆ]]
534365æ–‡å­—
æ™®é€šã«ã‚„ã£ã¦ã‚‚æ•°ç™¾å††ãªæ°—ãŒã™ã‚‹ãŒã€ã„ã¡ãŠã†1/10ãƒ‡ãƒ¼ã‚¿ã§è©¦ã™ã‹

## extraction
> Input was: ã€ŒA äº‹æ¥­è€…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³æ¡ˆã€ åˆ¥æ·»1.ç¬¬1 éƒ¨é–¢é€£/P13/20 è¡Œç›®ã€ŒAl ã«ã‚ˆã‚‹ãƒªã‚¹ ã‚¯ã€
> Response was: I'm sorry, but it seems like the text you provided is in Japanese and it's not clear how it relates to the task of refining arguments in English. Could you please provide an argument or statement in English that you would like me to work on?
- ã“ã‚Œã¯èª¤é€ä¿¡ã‹ãªã€œ

![image](https://gyazo.com/96d04b3dacc97adfd0532ea689148816/thumb/1000)
æ„å¤–ã¨å®‰ã„

`openai.error.InvalidRequestError: This model's maximum context length is 16385 tokens. However, your messages resulted in 17461 tokens. Please reduce the length of the messages.`
ã“ã‚Œã¯å›°ã‚‹ãª

è‰²ã€…å®Ÿé¨“ã®çµæœ
![image](https://gyazo.com/93fac38b5ca66a3704982db49350eb71/thumb/1000)
ãã‚ãã‚æœ€çµ‚ç‰ˆã‚’ä½œã‚ã†

å…¨éƒ¨å…¥ã‚Š
![image](https://gyazo.com/aba0d2524512bed37a47b1f360c3f2a3/thumb/1000)
ã†ãƒ¼ã‚“ã€ä¼æ¥­ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥ã‚ŒãŸã‚‰ãã‚Œã°ã‹ã‚Šå‡ºã‚‹ãª
- ä¸€èˆ¬äººã®ã‚³ãƒ¡ãƒ³ãƒˆãŒè–„ã™ãã‚‹ï¼Ÿ
- æ··ãœãŸæ–¹ãŒé¢ç™½ã„ã‹ã¨æ€ã£ãŸã‚“ã ãŒ...

å€‹äººã‹ã‚‰ã®2013ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã«é™å®šã—ã¦ã¿ã‚‹
`"clusters": 7`ã«ã—ã¦ã¿ãŸ

![image](https://gyazo.com/03cfc231950f8299513156ac1c034afb/thumb/1000)
ã†ãƒ¼ã‚“ã€ã‚ã¾ã‚Šå¤‰ã‚ã‚‰ãªã„ãª

ã‚ã€`"extraction" "limit": 12`ã“ã‚Œã‹
- 24ã«å¤‰ãˆã¦ã¿ã‚ˆã†

![image](https://gyazo.com/752caf0a8cdf21c1254f4e09eaca97be/thumb/1000)
å¢—ãˆãŸ
ã—ã‹ã—`Warning: data for page "/" is 170 kB which exceeds the threshold of 128 kB, this amount of data can reduce performance.`

ã•ã‚‰ã«48ã«å¤‰ãˆã¦ã¿ã‚‹

:

```
File "/Users/nishio/talk-to-the-city-reports/scatter/pipeline/steps/translation.py", line 102, in translate_batch
    parsed = [a.strip() for a in json.loads(response)]
```

`json.decoder.JSONDecodeError: Invalid \uXXXX escape: line 1 column 1098 (char 1097)`
ã†ãƒ¼ã‚“ã€ã“ã‚Œã¯å„ä»‹ã ãª

ã‚„ã‚Šç›´ã—ãŸã‚‰å‹•ã„ãŸ
- ãƒªãƒˆãƒ©ã‚¤ã®å®Ÿè£…ãŒä¸ååˆ†ã¨ã„ã†ã“ã¨ã‹ãªã€æœªç¢ºèª

![image](https://gyazo.com/4532c61d6dc74dbbf653aa1481fee36a/thumb/1000)
ã„ã„æ„Ÿã˜ã€ã‚„ã£ã±ã‚Šã“ã‚Œãã‚‰ã„ç‚¹ãŒãªã„ã¨ã€Œåˆ†å¸ƒã®å¯è¦–åŒ–ã§ã‚ã‚‹ã€ã¨ã„ã†æ„Ÿã˜ãŒã—ãªã„ã‚ˆã­
- å³ä¸‹ã®ã‚¯ãƒ©ã‚¹ã‚¿ãŒã¡ã‚‡ã£ã¨é›¢ã‚Œã¦ã‚‹æ„Ÿã¨ã‹

extructionã®limitã‚’ä¸Šã’ã‚‹ã¨ç‚¹ãŒå¢—ãˆã¦ã„ãã¨ã„ã†ã“ã¨ã¯ã€åºç›¤ã§ã€Œçµ„ç¹”ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ··ãœã‚‹ã¨çµ„ç¹”ã‹ã‚‰ã®æ„è¦‹ã°ã‹ã‚Šãƒ”ãƒƒã‚¯ã•ã‚Œã‚‹ãªãã€ã¨ãªã£ãŸã®ã¯ã€å˜ã«çµ„ç¹”ã‹ã‚‰ã®æ„è¦‹ã ã‘ã§limitã«é”ã—ãŸã¨ã„ã†ã“ã¨ã‹ã‚‚

æ—¥æœ¬èª2450æ–‡å­—ã®UTASã®ãƒ‡ãƒ¼ã‚¿ã¨534365æ–‡å­—ã®AIãƒ‘ãƒ–ã‚³ãƒ¡ã®ãƒ‡ãƒ¼ã‚¿ã§ã©ã£ã¡ã‚‚æ•°ã‚»ãƒ³ãƒˆã—ã‹ã‹ã‹ã£ã¦ãªã„ã®ã¯ã€limitã«å½“ãŸã£ã¦ã‚‹ã‹ã‚‰ã‹ã€‚
å®Ÿé¨“ã¨ã—ã¦ã¯ãƒªãƒŸãƒƒãƒˆã‚’ã‚‚ã£ã¨å¤§ããã—ã¦ã¿ã‚‹ã¹ãã ãªã€‚
limitã‚’48ã‹ã‚‰10000ã«å¢—ã‚„ã™ã€‚ã‚³ã‚¹ãƒˆã¨ã—ã¦ã¯7ãƒ‰ãƒ«ãã‚‰ã„ã ã‚ã†ã€‚

èµ°ã‚‰ã›ã¦ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã§ã‚‹
extraction.py

```
   comments = pd.read_csv(f"inputs/{config['input']}.csv")
   limit = config['extraction']['limit']
   comment_ids = (comments['comment-id'].values)[:limit]
```

ã‚ãƒ¼ã€ãªã‚‹ã»ã©ã€ãã†ã„ã†ã“ã¨ã­
ã˜ã‚ƒã‚2013äººåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã¯å…¥ã‚ŒãŸã‘ã©ã„ããªã‚Š48äººåˆ†ã«æ¸›ã£ã¦ã‚‹ã˜ã‚ƒã‚“ï¼

![image](https://gyazo.com/e0e1c18e00f5b575f2fa37ab845b0fd2/thumb/1000)
ã“ã“ã¾ã§ãã¦æ­»ã‚“ã 
:

```
 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 666/671 [29:36<00:13,  2.67s/it]
Traceback (most recent call last):
```

`openai.error.InvalidRequestError: This model's maximum context length is 16385 tokens. However, your messages resulted in 19680 tokens. Please reduce the length of the messages.`

185001345000002001ä»¥é™ã®ãƒ‡ãƒ¼ã‚¿ã«é–¢ã—ã¦ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒå¤‰ã‚ã£ãŸã®ã‹CSVæŠ½å‡ºã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§çµåˆã•ã‚Œã¦ã‚‹ãª
ãã‚Œã‚’æ‰‹ã§å‰Šã£ã¦1997ä»¶ã«ã™ã‚‹ã¨å‹•ããã†
ã—ã‹ã—ã¾ã‚ã“ã†è¨€ã†ã‚µã‚¤ã‚ºè¶…éãŒãªã„ã‹ã¯æŠ€è¡“çš„ã«ã¯å®Ÿéš›ã«APIã‚’å©ãå‰ã«ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ã‘ã ã—ã€è¶…éã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚‚ã†å°‘ã—ãƒ‡ãƒãƒƒã‚°ã—ã‚„ã™ãã—ãŸæ–¹ãŒã„ã„ãª

[[Polisã¯æ„è¦‹ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã€TTTCã¯ãƒˆãƒ”ãƒƒã‚¯ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°]]

ç„¡äº‹é€²ã‚“ã§ã‚‹
:

```
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 666/666 [30:12<00:00,  2.72s/it]
Running step: embedding
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:15<00:00,  2.65s/it]
Running step: clustering
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
2024-05-31 04:37:45,187 - BERTopic - Reduced dimensionality
2024-05-31 04:37:45,284 - BERTopic - Clustered reduced embeddings
Running step: labelling
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:04<00:00,  1.74it/s]
Running step: takeaways
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:16<00:00,  2.35s/it]
Running step: overview
```


> 185001345000002001ä»¥é™ã®ãƒ‡ãƒ¼ã‚¿ã«é–¢ã—ã¦ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒå¤‰ã‚ã£ãŸã®ã‹CSVæŠ½å‡ºã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§çµåˆã•ã‚Œã¦ã‚‹ãª
çµè«–ã€3ã¤ç›®ã®PDFã‹ã‚‰`â—å—ä»˜ç•ªå·`ã®å‰ã«ç©ºç™½ãŒã¤ã„ãŸã‚Šã¤ã‹ãªã‹ã£ãŸã‚Šã—ã¦ã„ã‚‹
- `â—å—ä»˜ç•ªå·`ã§å§‹ã¾ã‚‹ã“ã¨ã‚’åŒºåˆ‡ã‚Šæ¡ä»¶ã¨ã—ã¦ã„ãŸãŸã‚ã€çµåˆã•ã‚Œã¦ã—ã¾ã£ãŸã‚‚ã®ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨
- ç›´ã—ãŸã€2985ä»¶ã‚ã‚‹

:

```
 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       | 556/601 [1:33:50<07:35, 10.13s/it]
Traceback (most recent call last):
  File "/Users/nishio/talk-to-the-city-reports/scatter/pipeline/steps/translation.py", line 102, in translate_batch
    parsed = [a.strip() for a in json.loads(response)]
                                ^^^^^^^^^^^^^^^^^^^^
...
json.decoder.JSONDecodeError: Unterminated string starting at: line 1 column 382 (char 381)
```

ã„ã‚„ã„ã‚„ãƒã‚¸ã‹ã‚ˆ

ã“ã‚Œã¨åŒã˜åŸå› 
- > `json.decoder.JSONDecodeError: Invalid \uXXXX escape: line 1 column 1098 (char 1097)`
- > ã†ãƒ¼ã‚“ã€ã“ã‚Œã¯å„ä»‹ã ãª
- > ã‚„ã‚Šç›´ã—ãŸã‚‰å‹•ã„ãŸ
- > ãƒªãƒˆãƒ©ã‚¤ã®å®Ÿè£…ãŒä¸ååˆ†ã¨ã„ã†ã“ã¨ã‹ãªã€æœªç¢ºèª
æµçŸ³ã«1æ™‚é–“åŠå®Ÿè¡Œã—ã¦ã“ã‘ãŸã‹ã‚‰ã‚„ã‚Šç›´ã—ã£ã¦ã®ã¯...

ä¸€æ—¦ç¿»è¨³ã‚’OFFã—ã¦æœ€å¾Œã¾ã§ã‚„ã£ã¦ã¿ã‚ˆã†
![image](https://gyazo.com/3812304949fb72e6d10c8414abb84422/thumb/1000)
![image](https://gyazo.com/cad9b3292c1e806ab450e1e9f2682291/thumb/1000)

ä¾‹ãˆã°ã“ã‚Œã§ã€Œã‚¯ãƒ©ã‚¹ã‚¿æ•°ã‚’ã‚‚ã£ã¨å¤šãã—ã¦ã¿ã‚ˆã†ã€ã¨ã‹ã‚„ã£ãŸå ´åˆã«ã€ç¿»è¨³ã¯ã‚„ã‚Šç›´ã•ã‚Œã‚‹ã®ã‹ï¼Ÿ
- ã‚¯ãƒ©ã‚¹ã‚¿ã®è¦ç´„æ–‡ãªã©ã¯å†ç”Ÿæˆã•ã‚Œã‚‹ã‹ã‚‰å†ç¿»è¨³ãŒå¿…è¦ã ã¨æ€ã†ãŒã€extractionã®çµæœã¯ãã†ã§ã¯ãªã„ã‚ˆãª
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã¦å†åˆ©ç”¨ã•ã‚Œã‚‹ã¹ãã ã¨æ€ã†ãŒã€ãã®ä»•çµ„ã¿ã¯ã‚ã‚‹ã‹ãª

ã€Œå¾Œ5åˆ†ã§ç¿»è¨³ãŒçµ‚ã‚ã‚‹ã‹ã‚‰ã€çµ‚ã‚ã£ãŸã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦å¯ã‚ˆã€ã¨æ€ã£ã¦ãŸã‚‰ä¸­å›½èªç¿»è¨³ã®ãƒ•ã‚§ãƒ¼ã‚ºãŒå§‹ã¾ã£ãŸ(ã‚ã¨1æ™‚é–“ã¡ã‚‡ã„) å¯ã‚ˆ

2024-05-31
![image](https://gyazo.com/29a6818e0bb23986f1992c5ab5766713/thumb/1000)
ã§ããŸ

è‰²ã€…ãƒˆãƒ©ãƒ–ã£ãŸã‚Šã‚„ã‚Šç›´ã—ãŸã‚Šã—ãŸã‘ã©ã‚‚ã€æƒ³å®šé‡‘é¡ã«åã¾ã£ã¦ã‚‹ãª
![image](https://gyazo.com/a1b1c1f9c32359eef0543505a5e202b5/thumb/1000)

> ã€Œã‚¯ãƒ©ã‚¹ã‚¿æ•°ã‚’ã‚‚ã£ã¨å¤šãã—ã¦ã¿ã‚ˆã†ã€ã¨ã‹ã‚„ã£ãŸå ´åˆã«ã€ç¿»è¨³ã¯ã‚„ã‚Šç›´ã•ã‚Œã‚‹ã®ã‹ï¼Ÿ
:

```
% python main.py configs/aipubcom.json                       
(!) {'step': 'clustering', 'filename': 'clusters.csv', 'dependencies': {'params': ['clusters'], 'steps': ['embedding']}, 'options': {'clusters': 8}} step parameter 'clusters' changed from '7' to '50'
diff_params ['clusters']
So, here is what I am planning to run:
{'step': 'extraction', 'run': False, 'reason': 'nothing changed'}
{'step': 'embedding', 'run': False, 'reason': 'nothing changed'}
{'step': 'clustering', 'run': True, 'reason': 'some parameters changed: clusters'}
{'step': 'labelling', 'run': True, 'reason': 'some dependent steps will re-run: clustering'}
{'step': 'takeaways', 'run': True, 'reason': 'some dependent steps will re-run: clustering'}
{'step': 'overview', 'run': True, 'reason': 'some dependent steps will re-run: labelling, takeaways'}
{'step': 'translation', 'run': True, 'reason': 'some dependent steps will re-run: labelling, takeaways, overview'}
{'step': 'aggregation', 'run': True, 'reason': 'some dependent steps will re-run: clustering, labelling, takeaways, overview, translation'}
{'step': 'visualization', 'run': True, 'reason': 'some dependent steps will re-run: aggregation'}
Looks good? Press enter to continue or Ctrl+C to abort.
```

ç¿»è¨³ã¯å¤‰ã‚ã‚‹éƒ¨åˆ†ã ã‘ã§æ¸ˆã‚€ã¿ãŸã„

:

```
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 606/606 [2:31:52<00:00, 15.04s/it]
Translating to Taiwan...
  9%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                                                              | 53/606 [08:00<1:13:18,  7.95s/it]
```

ãˆï¼Ÿ2æ™‚é–“åŠã‹ã‘ã¦ç¿»è¨³ã—ç›´ã—ã¦ã‚‹ã¿ãŸã„ã ã‘ã©ï¼Ÿww

:

```
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 605/606 [1:38:47<00:09,  9.80s/it]
Traceback (most recent call last):
  File "/Users/nishio/talk-to-the-city-reports/scatter/pipeline/steps/translation.py", line 119, in translate_batch
    return translate_batch(batch, lang_prompt, model, retries - 1)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
...        
RecursionError: maximum recursion depth exceeded
python main.py configs/aipubcom.json  56.16s user 33.46s system 0% cpu 4:13:37.44 total
```

ãªã‚“ã ã“ã‚Œ [full stacktrace](https://gist.github.com/nishio/b5e54d84a080fa7397559f32ee48dc84)
4æ™‚é–“ã‹ã‹ã£ãŸä¸Šã§ç¢ºç‡çš„ã«ã—ã‹ç™ºç”Ÿã—ãªã„ã‚¨ãƒ©ãƒ¼ã§å¤±æ•—ã—ã¦ã‚‹ãª
![image](https://gyazo.com/08143c5154dee81bf134625d3c8f31f4/thumb/1000)
ã‚³ã‚¹ãƒˆã¯ãã‚“ãªé«˜ããªã„ã‚“ã ã‘ã©
ãã‚‚ãã‚‚ä»Šå›ã®ã‚¯ãƒ©ã‚¹ã‚¿æ•°ã‚’å¤‰ãˆãŸã ã‘ã®ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã§4æ™‚é–“ã‹ã‘ã¦ç¿»è¨³ãŒèµ°ã‚‹ã®ã¯ä½•ã‹é–“é•ã£ã¦ã‚‹ã—
ç¢ºç‡çš„ã«ç™ºç”Ÿã™ã‚‹ãƒˆãƒ©ãƒ–ãƒ«ã®ã‚±ã‚¢ãŒè¶³ã‚Šã¦ãªã„ã®ã§ãƒ‡ãƒ¼ã‚¿ãŒå¤§ãããªã‚‹ã»ã©ã‚„ã‚ŠãªãŠã—ã«ãªã‚‹ç¢ºç‡ãŒé«˜ã¾ã‚‹

![image](https://gyazo.com/c9a671b43b4488ac2c82390ac847e3d3/thumb/1000)
æ—¥æœ¬èªç‰ˆã®ç¿»è¨³ã¯æ¸ˆã‚“ã§ã‚‹ã‘ã©å°æ¹¾ç‰ˆã§ã“ã‘ãŸã®ã§æ—¥æœ¬èªè¨³ã®ãƒ‡ãƒ¼ã‚¿ã‚‚ãªã„
50ã‚¯ãƒ©ã‚¹ã‚¿ã«åˆ†ã‘ãŸã‚‚ã®ã¯è‰²ã€…å€‹æ€§çš„ã§é¢ç™½ã„
ã“ã®ãã‚Œãã‚Œã®ã‚¯ãƒ©ã‚¹ã‚¿ã‹ã‚‰1å€‹ã®è³›å¦åˆ†ã‹ã‚Œã‚‹å•ã„ã‚’ä½œã£ã¦Polisã™ã‚‹ã¨ã‹ã‚‚é¢ç™½ã„ã‹ã‚‚

ä»Šå¾Œã®æ–¹å‘æ€§
- æ—¥æœ¬èªã®å…¥åŠ›ã§æ—¥æœ¬äººå‘ã‘ã«å‡ºã™ãƒ¬ãƒãƒ¼ãƒˆã«é–¢ã—ã¦ã€ç¾åœ¨å†…éƒ¨ã§ä¸€æ—¦è‹±èªã«ã—ã¦ã„ã‚‹ã®ã‚’ã€è‹±èªã«ã›ãšã«æ—¥æœ¬èªã®ã¾ã¾å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹
- ç¿»è¨³ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã‚‚ã†å°‘ã—æ”¹å–„ã—ã¦ã€ã¾ãšç¿»è¨³ãªã—ã§è‹±èªã§ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ç¢ºèªã™ã‚‹ã¨ã“ã‚ã¾ã§ã‚„ã£ã¦ã‹ã‚‰ã€è¿½åŠ ã§æ—¥æœ¬èªã€â€¦ã¨å¾Œã‹ã‚‰è¨€èªã‚’å¢—ã‚„ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹
- 2000äººæ–‡ã®ãƒ‘ãƒ–ã‚³ãƒ¡ã§5000ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã¨ã‹ä½œã‚‰ã‚Œã¦ã€ãã‚ŒãŒå…¨éƒ¨ãƒ—ãƒ­ãƒƒãƒˆã•ã‚Œã¦ã‚‹ç¾çŠ¶ã§ã¯2ä¸‡äººã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹ã“ã¨ã¯å›°é›£ã€å‰æ®µéšã§ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã‚’æ›ã‘ã¦ä¼¼ãŸæ„è¦‹ã‚’ä¸€ã¤ã«ã¾ã¨ã‚ã‚‹


2024-06-03
[[Talk to the Cityã§Pluralityæœ¬ã®å†…å®¹ã‚’å¯è¦–åŒ–]]
![image](https://gyazo.com/516d87e486692d3102793a8b5b27461e/thumb/1000)
ãˆãƒ¼ã€ã“ã†ã„ã†ã‚´ãƒŸãŒç”Ÿæˆã•ã‚Œã¦ã—ã¾ã£ãŸæ™‚ã«ãƒ•ã‚£ãƒ«ã‚¿ã™ã‚‹ã«ã¯...
- å…¬å¼ã®æ‰‹è»½ãªæ–¹æ³•ã¯ãªã•ãã†

`embedding.py``ã«ãƒ•ã‚£ãƒ«ã‚¿ã‚’æ›¸ãåŠ ãˆã¦å¼·åˆ¶å†å®Ÿè¡Œã™ã‚‹

util.py

```
    for (i, option) in enumerate(sysargv):
        if option == '-f':
            config['force'] = True
        if option == '-o':
            config['only'] = sysargv[i + 1]
        if option == '-skip-interaction':
            config['skip-interaction'] = True
```


ã‚ãƒ¼ã€ã ã‚ã ã€ã“ã“ã¯ãƒã‚§ãƒƒã‚¯ã•ã‚Œã¡ã‚ƒã†ã®ã‹
`ValueError: Make sure that the embeddings are a numpy array with shape: (len(docs), vector_dim) where vector_dim is the dimensionality of the vector embeddings. `

æ‰‹å‰ã®args.csvã‚’æ›¸ãæ›ãˆã‚‹ã—ã‹ãªã„ã‹
filter_argument.py

```
import pandas as pd

# Load the arguments from the CSV file
arguments = pd.read_csv("outputs/plurality/args.csv")

# List of arguments to ignore
ignores = ["error", "argument", "reference", "references", "source", "sources", "message", "contributions"]

# show size
print(len(arguments))

# Filter out the ignored arguments
filtered_arguments = arguments[~arguments['argument'].isin(ignores)]

# show size
print(len(filtered_arguments))

# write filtered_arguments to output/plurality/args.csv
filtered_arguments.to_csv("outputs/plurality/args.csv", index=False)
```


`arguments_array.shape=(3497,), embeddings_array.shape=(3353, 1536)`
argsã‚’æ›´æ–°ã—ãŸã®ã«ãªãœã‹å†å®Ÿè¡Œã•ã‚Œã¦ãªã„ãªã€å†åº¦-oã§forceã™ã‚‹ã€‚
`arguments_array.shape=(3497,), embeddings_array.shape=(3497, 1536)`
ã§ããŸ

ãŠãŠãƒ¼ã€ã‚ˆããªã£ãŸ
![image](https://gyazo.com/fe17a549997d15573ac078150958add6/thumb/1000)
ãƒªãƒªãƒ¼ã‚¹ã—ãŸ
[https://nishio.github.io/tttc_plurality/](https://nishio.github.io/tttc_plurality/)

2024-06-17
> Encountered 15 files that should have been pointers, but weren't:


