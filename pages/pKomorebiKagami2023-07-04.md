
prev [[pKomorebiKagami2023-07-03]]
投票の更新できた

100票投票してみる
- error unhandledRejection: error: new row for relation "votes" violates check constraint "votes_vote_value_check"
- 正しく拒否された

投票結果の集計できた

RDBはシンプルな投票データの保持に専念させて、その他のUI的なことはFirestoreにしようと思う
- 例えばトピックの中に複数の質問がある的な構造はRDBではなくFirestoreに置く
    - オリジナルのPolisの「トピックの中に複数の質問があり、1:N」という関係は今までの検討で柔軟性が足りないなぁとなっているところなので。

ネクストアクションを考える
- トピックと質問リストをFirestoreに置く
    - いま質問リストは一つ一つ送信しないといけなくて面倒なので複数行まとめて送信できるようにする
    - みんなが投票して結果が可視化されるところまでやる

ここまでできた
- ![image](https://scrapbox.io/files/64a3e80fce7767001b3dc44a.png)
- ユーザがそのトピックの質問に答えてるかどうかをまず取得して、そのデータを元にまだ答えてなかったら結果を非表示にしよう
    - それは後でいいか
    - いや再訪した時に過去に投票したのがわからないからやっぱ必要
    - 自分の過去の投票を取得して表示を変えられるようになった
        - まだ見た目は酷いけど
    - ![image](https://gyazo.com/57dfecfbeb2f9c1cbb83685052306059/thumb/1000)
今日のまとめ
- ブラウザ上のUIから投票できるようになった
    - 自分の過去の投票を見れる
    - 投票は修正できる
- 質問ごとの投票の集計結果が棒グラフで出るようになった
