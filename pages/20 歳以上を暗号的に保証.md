---
title: "20 歳以上を暗号的に保証"
---

<img src='https://scrapbox.io/api/pages/nishio/o3/icon' alt='o3.icon' height="19.5"/>
「20 歳以上」を暗号的に保証する 3 つのレベル

デジタル庁 API（現行）
- マイナンバーカード ➜ デジタル認証アプリ ➜ JWS
- 属性キー age_over_20=true
- デジタル庁（JWS）が署名
- サービス側に渡る情報: sub（PPID）＋age_over_20=true だけ
- ⭕ 生年月日や氏名は出さない
- ①利用者がカード＋PIN認証
- ②App が JWS を RP に POST
- ③RP は公開鍵で JWS 検証

B. [[mDL]] / [[mdoc]]（今年度スマホ搭載予定）
- カード発行情報を [[mdoc]] としてスマホに格納
- データ要素にage_over_20ブール値を含む
- Document Signer CA（政府系）が署名
- サービス側に渡る情報: age_over_20 のみ（ASN.1 署名付き）
- ⭕ 端末ローカルで完結
- ①アプリが NFC/BLE で mdoc 取得
- ②[[X.509 チェーン]]検証→age_over_20 読み取り

C. ZK Range Proof（概念実装）
- 生年月日を [[Pedersen Commitment]] しBulletproofs などで 「 birth_date ≤ 2005-07-11 」 を ZK 証明
- ユーザ自身が ZKP 生成
- 証明鍵は不要
- 證明書サイズ数 kB の ZKP
- ◎ 年齢以外は数ビットも漏れない
- ①カード or Issuer が CL/BBS+ 署名した credential を所持
- ②ユーザが Bulletproofs で commitment ≤ lim 証明
- ③RP は公開パラメータで検証

まだ雑なので徐々に整理する
private chat: [https://chatgpt.com/c/6870ab73-62e4-8011-8170-78d0b7756af8](https://chatgpt.com/c/6870ab73-62e4-8011-8170-78d0b7756af8)

