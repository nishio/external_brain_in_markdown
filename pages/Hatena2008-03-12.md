
hatena

```
<body>
*1205286191*だいぶ落ち着いた
落ち着いていないときに書いた記事がネットワーク不良で送信されていなかったのを、落ち着いてからネットにつないだときに送られてしまった(苦笑

*1205288863*Jython2.2.1での日本語の扱いについて
きっちりまとめる時間がないので書き殴り。

>||
>>> print "こんちは"
こんちは
||<

これはうまく行くので一見問題ないように見える。しかしこれはバイト列として扱われていて、たまたまPythonのprintではちゃんと表示できるだけ。

>||
>>> repr("こんちは")
"'\\x82\\xB1\\x82\\xF1\\x82\\xBF\\x82\\xCD'"
>>> from java.lang import *
>>> s = "こんちは"
>>> System.out.println(s)
?±??????
||<

そこでユニコード文字列にしようと思うわけだが、sjisのコーデックはない。
>||
>>> System.out.println(unicode(s, "sjis"))
Traceback (innermost last):
  File "<console>", line 1, in ?
LookupError: unknown encoding sjis
||<

ちなみに
>||
>>> sys.defaultencoding
'ascii'
||<

僕の作ったコーデックを入れてsite.pyでデフォルトエンコーディングをsjisにする(これがダメかも。あとで調べる)

>||
>>> s = "こんちは"
>>> s
'\x82\xB1\x82\xF1\x82\xBF\x82\xCD'
>>> print s
こんちは
>>> unicode(s, "sjis")
u'\u3053\u3093\u3061\u306F'
>>> print _
こんちは
||<

うまくいった。

System.out.printlnでもユニコード文字列を渡せばOK

>||
>>> System.out.println(_)
こんちは
>>> System.out.println(s)
?±??????
||<

あ、site.pyに"sjis"って書いたので下でもOK

>||
>>> System.out.println(unicode("こんにちは"))
こんにちは
||<

ここまではOKなの。だから実用上は日本語が含まれうるなら明示的にunicodeで囲むようにすればいいだけ。問題はここ

>||
>>> u"こんにちは"
u'\x82\xB1\x82\xF1\x82\xC9\x82\xBF\x82\xCD'
||<

ユニコードリテラルがバイト列のままユニコードになっている。

もう一つ、ユニコード文字列の文字列フォーマット操作が上位バイトをドロップする

>||
>>> unicode("あ == %s")
u'\u3042 == %s'
>>> _ % unicode("あ")
u'B == B'
||<

とまぁ、(執筆中にその内容をブログに書くのはどうかという気もするけど)現状で僕が把握しているのはこんな感じ。

エンコードやユニコードの話が出てくるところではunicodeで変換してうんぬんって話を入れてあるんだけども、その手前のhello, worldって章でGUIに「こんにちは世界！」とか出しているところにあんまりページを割いてこの話をすると何のための「最初にさらっと試してみる章」なのかがわからなくなるので、日本語を出すのをやめて「Hello, world!」に変えるのがいい解決方法だと思う。しかしソースコードと原稿でもれなくコードクローンになっていて修正箇所が2倍な上に、少しずつ書き換えていく解説方法なのでさらにクローンだらけ。

僕が今までプログラミングを教える上で、一番重視してきたのは「コードクローンを作らない」ということ。Pythonのfor文にはelseがつけられて～とか最近のJavaではfor文にコロンが入って～なんてのは本質的でない知識で、時とともに変化するし違う言語に移行したときに使えない。一方で「コードクローンを作らない」とか「機械的な作業を人間がやらない」とかはより汎用的な知識だ。

そういうことをえらそうに語ってきておいて、自分がコードクローンまみれになっていて仕様変更が起きたときに修正箇所がたくさんあって大変だということに気づけなかったことに激しく自己嫌悪に陥ったのだけど、まぁそんなことを言っていても原稿が完成しないのでとりあえずは目の前の作業を終わらせてから考えることにする。

*1205296617*Jython本
本のタイトル、最初僕は「しかくいJavaとやらかいPython」とかそういうノリで提案していたのだけども、結局「Jythonスーパーマニュアル」という堅いタイトルになってしまって、タイトルに引きずられる形でリファレンスマニュアル的なまじめな本を書こうとした。

僕なりにPythonを知らない、Jythonも知らない、そういう人向けにJythonの解説を書いたが、どう考えても「スーパーマニュアル」って感じじゃないなぁ。
どちらかというとエッセイ集。「しかくいJavaとやらかいPython　～Jythonにまつわるエトセトラ～」とかが一番内容を正確に表現しているんじゃないだろうか。でも「そんな雑誌の一特集みたいなタイトルはダメ」って言われたんだよなぁ。

*1205296860*メンテナビリティ
思いつきで原稿をwc -lしてみた。1万行超えていた。型チェックも回帰テストもないあいまいな日本語で書かれたソースコードが1万行とかひどいよね。品質を保つために頑張ってはいるけども、やっぱりいろんな不具合があるんじゃないだろうか。ソフトウェアの品質を高めるのに似た方法で文章の品質を向上させられないか。特にコピペは禁止にしないと。

*1205305024*さらけだし
ブログでさらけ出してフィードバックをもらうことになれていると、フィードバックなしで長期間にわたって一つの内容を書くことに強い不安とストレスを感じるようになる。
昔は誰もフィードバックしてくれなかったはずなのにな。いつの間にこうなったんだろう。

*1205322529*Amazonのウィッシュリスト
あー。デフォルトで本名と一緒に公開されているという騒ぎを聞きつけて確認してみたけど、なんかすでに買った本がたくさん含まれているなー。ウィッシュリストに入れた記憶のない本も含めて71冊もあるけど、きっと入れたの忘れただけなんだろうなぁ。Molecular Cell Biologyとか。

すでに買った本もたくさんあるし、ウィッシュリストに入れっぱなしで結局買っていない本とかって買わなくていい本だと思うんだよね。このリストを公開しておくのは単純にノイズでしかないので一括消去したいな。

騒動が落ち着いたら、読んでみたいけど買うほどではない本をリストに入れて「持っていたら貸してください」って言うグループを作ると面白いかも。アマゾン涙目。

-----

>>
80,000点に学ぶ新製品開発マーケティング
リストに加えられた日付 2002年 9月 13日
<<

へー。レジに持って行った(ぇ

*1205323295*リアルタイム共有型ホワイトボード『Twiddla』
<a href="http://www.100shiki.com/archives/2008/03/twiddla.html">手軽に使えるリアルタイム共有型ホワイトボード『Twiddla』 | 100SHIKI.COM</a>
とかはてなセリフとか、自分の作りたかったものに似たコンセプトのものがどんどんリリースされてきて少し焦りを感じる今日この頃。とりあえず執筆終わったら↑を試す。

まぁ、共有型ホワイトボードなんてたぶん世界で10万人くらいの人が「いつか作ろう」と思っているに違いないので、コアはそこではないに違いない。

*1205333771*そうだ
久しぶりに日付が変わる前に寝よう
</body>
<comments>
<comment>
<username>mktn</username>
<body>IT系の書籍編集をやっている者です。<br><br>当たり前ですが、コンピュータ言語に比べると日本語は冗長なので、読者が迷わない<br>ようなエラー処理も含めながら書くと長くはなります。<br><br>しかし、初めて書籍を書かれたなら、長さよりも思うことをあますところなく書いて、<br>編集者に見てもらうほうが大切です。編集者は西尾さんよりpythonのことはわかり<br>ませんが、python本としてのバランスを見ることはプロのはずです。<br><br>初心者プログラマが「どうしてもきれいなアルゴリズムが書けなくて」と悩んで<br>いるのを見たら、「ある程度までがんばったら、一度先輩に見てもらえよ」と<br>言いたくなりませんか？　初心者が最初から完璧を目指しても、完璧から遠ざ<br>かることのほうが多いように思います。<br><br>そういう意味では、書籍制作は編集者とのペアプログラミングだと思ったほうが<br>近いかもしれません。</body>
<timestamp>1205299041</timestamp>
</comment>
<comment>
<username>nishiohirokazu</username>
<body>>書籍制作は編集者とのペアプログラミング<br><br>なるほど。だいぶ気が楽になりました。ありがとうございます。<br>とりあえずは自分のできる範囲で頑張って、あとでリファクタリングしたいと思います。</body>
<timestamp>1205301159</timestamp>
</comment>
<comment>
<username>amachang</username>
<body>テラ共感ス</body>
<timestamp>1205305447</timestamp>
</comment>
<comment>
<username>mwada</username>
<body>未踏ユースとかとも関連して、<br>西尾さんはどっかで先生やるのも向いてる気がします。</body>
<timestamp>1205308495</timestamp>
</comment>
<comment>
<username>mktn</username>
<body>非常に良いセンスをお持ちだと思います。<br>中身を書いている著者がつけたタイトルなので、最もよく内容を表しているのだと思いますし、<br>キャッチ力もあります。これだけでpythonって柔軟にいろいろ書けて、Javaの融通の利かない<br>ところを救ってくれるのかも、と思わされます（違っていたらすみません）。<br><br>ただし、こうした雰囲気のあるタイトルは対象の認知度が高い場合でないと、セールス的には<br>苦しくなるのではないかと思います。このタイトルだと、この本を手に取る「pythonを知らない<br>人」は限定されてしまうように思いますから。<br><br>たとえば、「入門Luaプログラミング」というタイトルを見たとき、Luaを知らない人は「Lua<br>という新しいプログラミング言語があるのか、聞いたことないな」と思いながら、どんなも<br>のかはペラっと見てみるでしょう（聞いたことないから見もしないという人はpython本でも対<br>象外でしょうから、ここでは考慮しません）。プログラミング言語であるというある種の手が<br>かりがタイトル内にありますから。<br><br>でも、これが「我が思い出のLua」だと、Luaを知っている人しか開かないと思われます<br>（書店でよっぽど好位置を確保できれば別ですが）。だから、これがたとえば「しかく<br>いJavaとやらかいC」なら手がかりは不要なので、成立するだろうと思うわけです（Java<br>もCもメジャーですから）。<br><br>ただし、出版社側がつけたであろう「Jythonスーパーマニュアル」には私も賛成はできま<br>せん。非常に凡庸で、事務的な感じがします。そもそも「マニュアル」というのは、「対<br>象はよく知っているが、使い方がよくわからない」という人に向けた本に使うべきかと。<br>そういう意味では、Excelとかそういう類の仕事で覚えなくてはならないアプリ本に使う<br>べきだと思います。対象読者はすでに使わないといけないという強迫観念にとらわれて<br>物色に来ているわけで、タイトル力で興味を喚起する必要がないわけですから。<br><br>タイトルには、内容に対する的確さ、セールス的な効果、そして関係者の好みなども<br>関係してくるので、いつももめるところではあります。</body>
<timestamp>1205324549</timestamp>
</comment>
<comment>
<username>kuboon</username>
<body>nishio案に一票。</body>
<timestamp>1205739417</timestamp>
</comment>
</comments>
```


[はてなダイアリー 2008-03-12](https://nishiohirokazu.hatenadiary.org/archive/2008/03/12)