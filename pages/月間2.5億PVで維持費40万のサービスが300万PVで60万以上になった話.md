---
title: "月間2.5億PVで維持費40万のサービスが300万PVで60万以上になった話"
---

> [Peing_net](https://x.com/Peing_net/status/1959252696550002973) 皆様には混乱をお招きしましたこと謹んでお詫び申し上げます。
>
>  現状、インフラ費用だけで毎月50万円近い赤字が出ている状況ですので、まずはインフラの最適化や非効率なコードの見直しを早急に行う必要がある状況です。
>  （その状態でもなんとか運営を続けられていた元会社さんを尊敬です）
>  (2/3)
> [Peing_net](https://x.com/Peing_net/status/1959252698320314543) また、コード全体がRailsで作られていることもサーバ負荷の原因となっており、部分的にでもGoやNodeへの置き換えを予定しております。 ...

> [sesere115](https://x.com/sesere115/status/1959484141986275599) 質問箱の件は、「Rails使うと儲からないの？」と勘違いされたくないので一応言っておきますが、（細かい数字は忘れましたが）ぼくが渡した時点では毎月数百万黒字が出ている状態で渡したはずです。どんなに最低でも200万は黒だったはずです
>
>  だから戦略やインフラの失敗の方が本質だと思います


> [sesere115](https://x.com/sesere115/status/1959478836883771886) 面白い話題が流れてきたので、、、
>
>  ぼくが運営していた、月間2.5億PVの時点でサーバー費用は月15万円+メール送信費用で月15万円で計30万円くらいだった気がします（どんなに高くても40万はいってなかったはず）
>  ほぼ最適化をせずにその金額だったので、必要ないのにawsに載せたり富豪的な使い方をしてエグレス料金が跳ね上がってたり、「Railsに問題があるのではなくインフラに問題がある」という状況なんじゃないかなーと思っちゃいます（譲渡後にどのような機能が追加されたか知らないのであくまでもベース機能に関してですが）
>
>  蛇足ですが、そもそも設計時点で画像もテキストもTwitterで展開する事でユーザーがサイトにアクセスしないようにして、インフラコストをTwitterに負担させて抑制する事でインフラ費用を抑えると言う方針でやっていました（それでも2.5億PV/月あったけど）
>
>  あとインフラもconoha vpsでやってたはずであそこはエグレス料金がかからない
> [sesere115](https://x.com/sesere115/status/1959482445528776736) これに限らずawsは全てが高いので採用するのは最後の最後の選択肢だと思ってまずは他の手段（vpsの並列化/fly.ioなどのPaaS）を優先して考えるべきかなーと
>
>  収益化構造がしっかりしてるサービスならともかく、viewを伸ばす＝収益となる広告型サイトでエゲレス料金の高いawsを使うのは現実的じゃない


> [kenn](https://x.com/kenn/status/1959672461588680942) 安易にRailsのせいにしてる時点でボトルネック分析甘そう。
>
>  自分も昔に月間10億ヒットのAPIをRailsで30万/月ぐらいのコストでさばいてましたが1/3以上はDB費用でした。同じく安易にAWS等を使わずVPSを使う、というのがコスト抑制に一番効きましたね。


> [Peing_net](https://x.com/Peing_net/status/1959506538437226550) ■Railsが本当に問題なのか？
>
>  →　挙動的にアプリケーションサーバの負荷が問題に見えるるための発言ですが、まだ詳細確認中です。
>  まずはクエリ最適化とDB見直し、一部画面の静的化が急ぎと考えています。
>  全面リファクタリングは高コストすぎるので、やっても高頻度・高負荷のAPIだけ外出しかと。
> [Peing_net](https://x.com/Peing_net/status/1959506540378857875) なおピーク時は1億PV/月あったそうです。
>  現状でも300万PV/月あり、Railsのようなスクリプト言語で全て書く規模ではないと考えています。
>  （PHP, Python含めてです。Ruby/Railsだけをディスる意図は全くないです）
> [Peing_net](https://x.com/Peing_net/status/1959506542342099375) ■何にそんなに費用がかかっているのか？
>
>  →　現状で、アプリケーションサーバ（Compute Engine）が月20万円、Cloud SQL（DB）が月40万円、その他もろもろとなっています。
>  DBが3TBあり、ストレージ料金だけでエグいです。不要なデータも保存しているようなので、その削除も課題になりそうです。


> [kenn](https://x.com/kenn/status/1959676721583849752) って実際は300万PV/月だった…
>  この程度のかわいい規模で「スクリプト言語で書く規模ではない」という思い込みが発動するの、やっぱりボトルネック分析が甘いという予想通りだった
>  DBデータ削除はクソ重くて死ぬので、一気に消さないよう気をつけてね。将来はパーティショニング導入を。
> [kenn](https://x.com/kenn/status/1959682831959126127) プログラミングが主任務でシステムのアーキテクトをやってないエンジニアは、プログラミング言語の違いを過大評価しがちなんですよね。ある程度の複雑さを持つシステムにおいて、全体の律速段階がプログラムの実行速度にあることはむしろ稀です。
