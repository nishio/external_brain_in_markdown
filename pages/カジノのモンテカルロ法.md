
本来のモンテカルロ法とまったく別の概念が賭博の分野でモンテカルロ法と呼ばれてる話を聞いて、調べてみたらまあまともな戦略ではなかった
- 本来のモンテカルロ法: [モンテカルロ法 - Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%A2%E3%83%B3%E3%83%86%E3%82%AB%E3%83%AB%E3%83%AD%E6%B3%95)

カジノのモンテカルロ法(2倍配当の場合)
- 紙に1,2,3と書く
- A: 両端を足した数xを賭ける
- 勝ったら列の両端を消す
- 負けたら右端にxを追加する
- 列の長さが1でないならAに戻る

まず、列の長さが最初は3で、勝ったら2短くなり、負けたら1増えるわけで、「負け勝ち勝ち」の順だと列の長さが0になるバグったアルゴリズムなのだが…、0の場合は停止することにしよう。
運の悪い時には停止しないまま長く続いてしまうので100回で打ち切ることにする
python

```
from collections import Counter
from random import random, seed
seed(1)


def f():
    xs = [1, 2, 3]
    ret = 0
    for i in range(100):
        if len(xs) < 2:
            break
        x = xs[0] + xs[-1]
        ret -= x
        if random() < 0.5:
            ret += 2 * x
            xs = xs[1:-1]
        else:
            xs.append(x)
    return ret


c = Counter(f() for i in range(1000000))
```


100万回実験して、1回のセッションでの利益の頻度を高い順に20個出したのが下記
- 高い確率で少し得をして、低い確率で大きな損をすることがわかる
- 94%くらいで得をしてセッション終了する
- 得をする時の期待値は4.2
- 損をするときの期待値は-75.6
- 最も損をするケースは今回の実験では-829536
:

```
[(4, 499951),
 (6, 236607),
 (3, 124839),
 (2, 38641),
 (1, 29213),
 (-1, 12488),
 (0, 10124),
 (-2, 6393),
 (-3, 5220),
 (-4, 4173),
 (-5, 3570),
 (-7, 2559),
 (-6, 2437),
 (-8, 2084),
 (-10, 1535),
 (-11, 1433),
 (-9, 1363),
 (-12, 1042),
 (-13, 960),
 (-14, 857)]
```


83万円損するのはおかしいか？
- おかしくない。
- いったん負けて終了しないぐらい勝つことを繰り返すと、負けるたびに賭け金が増え、勝っても賭け金は減らず左端が消えることで「負けたときの賭け金の増額」が増え、この「増額の増分」が過去の賭け金なのでやばいサイクルに入る
    - [https://gist.github.com/nishio/877c13738786d35fd7fbfae243e649c5](https://gist.github.com/nishio/877c13738786d35fd7fbfae243e649c5)
