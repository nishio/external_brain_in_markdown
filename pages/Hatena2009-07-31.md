---
title: "Hatena2009-07-31"
---

hatena

```
<body>
*1249001102*足
<img src="http://gyazo.com/36805a719500e09202afa02c42128e3b.png">

毎回回路図を眺めるのは面倒なので描いた。

*1249004749*今日の電子工作
昨日作った心拍センサを早速耳に挟んでみる。Arduinoのシリアルモニターを眺めながら脈を測ってみると、ちょうど脈を打つあたりで値が増えていることがわかる。心拍をとるには十分そうだ。Arduinoの上でFFTをするのはどうかと思うのでこの値をProcessingか何かで取ってやればいいかな。

ところで、外界の光が入りにくいように大分工夫はしてあるけどもそれでも窓の方をむいたりするとレベルが大きく変わる。というか耳のどこに挟むかで大分違う。1024のレンジには収まっていて心拍の振れが4くらいなのでソフトウェア的に頑張ればOKかな。

僕の心拍:
>||
482**-----------------------------
481*------------------------------
480-------------------------------
481*------------------------------
481*------------------------------
482**-----------------------------
481*------------------------------
482**-----------------------------
481*------------------------------
482**-----------------------------
482**-----------------------------
483***----------------------------
483***----------------------------
482**-----------------------------
483***----------------------------
483***----------------------------
484****---------------------------
483***----------------------------
483***----------------------------
482**-----------------------------
482**-----------------------------
481*------------------------------
481*------------------------------
480-------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
482**-----------------------------
482**-----------------------------
482**-----------------------------
483***----------------------------
483***----------------------------
483***----------------------------
484****---------------------------
484****---------------------------
484****---------------------------
485*****--------------------------
485*****--------------------------
484****---------------------------
483***----------------------------
483***----------------------------
483***----------------------------
483***----------------------------
482**-----------------------------
482**-----------------------------
481*------------------------------
481*------------------------------
482**-----------------------------
481*------------------------------
482**-----------------------------
481*------------------------------
481*------------------------------
481*------------------------------
481*------------------------------
482**-----------------------------
||<

delay 10msで 38回のサンプリングで1周期なので380msで1拍だとすると心拍数は300くらいで、もちろんそんなはずがないのでグラフを作ってシリアル通信で送るのにかかる時間が含まれていない。PC側で動くプログラムを作ってそちらで送られてきた時間を見るようにするべきなんだな。

<hr>

脳波センサー用のICが届いたよ！わーい！

<hr>

Processingインストールした。

<img src="http://gyazo.com/5c7262911b76a47aadb12fd0fef1dd3d.png">

人間の目で見ると拍動しているのは明らかなんだけど、これをソフトウェア的に取り出すのが面倒そうだね。すなおにフーリエ解析するしかないかな。ちなみに下の方のぶるぶるしているのは腕を振ってみたところ。

まじめにコードを書くならもうちょっとまじめにProcessingを勉強しないと行けないかな。

アドホックなチューニングとかしないで512なり1024なりデータを溜めてFFTするコードを書くべきなんだろうなー。

- 心拍センサ: ハードウェア完了、ソフトウェア側でFFTする必要がある
- 脳波センサ: プロトタイプ1に必要なICが揃った。足りないもの: 電極、アンプに+-12Vくらいの電流を供給する必要があるが、スイッチングするやつではノイズが乗ってしまうので<a href='http://ja.wikipedia.org/wiki/%E4%B8%89%E7%AB%AF%E5%AD%90%E3%83%AC %E3%82%AE%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BF'>三端子レギュレータ</a>を使うか6P電池を使うか。高いよね、6P電池。再利用も考えてエネループを24本…6000円くらいかな

*1249013615*Processing
UIがArduinoとほとんど同じだ(笑)

<a href='http://processing.org/learning/gettingstarted/'>Getting Started \ Processing 1.0</a>
<a href='http://kousaku-kousaku.blogspot.com/2008/05/arduino- processing.html'>建築発明工作ゼミ2008: Arduino-Processing　シリアル通信１</a>
ここら辺を参考にした。

<hr>

どこからが「電子工作」でどこからが「プログラミング」なのか曖昧だが、とりあえずArduino経由で心拍のデータをとって画面に表示するProcessingのプログラムができた。一つ前のエントリーを参照。で、心拍の周波数を取るためにはFFTを掛けるのが一番筋のいい手だろうなぁ、と思ってたら、あるし:<a href='http://code.compartmental.net/tools/minim/manual-fft/'>Code Log &#183; Manual: FFT</a>。Processingは便利ですな。後でこれを使うことにしよう。
</body>
```


[はてなダイアリー 2009-07-31](https://nishiohirokazu.hatenadiary.org/archive/2009/07/31)