---
title: "Mac日記2022"
---

2022-11-15
新しいマシンの環境構築をする必要がある
- 会社の管理ツールの関係で移行ツールでの移行ができなくなった
- なのでゼロから構築する必要がある

細切れ時間でやってたら何が何だかよくわからなくなった
- きちんと考えを書きながら進めないとダメ

移行ツールでの移行はできなくなった
- 直前のマシンまでは移行ツールを実行して寝たら翌朝には新しいマシンに今まで通りの環境が出来上がっててすぐに作業が続行できた
- 移行ツールが何らかの管理ツールと衝突するようになり利用できなくなった
- そうなると「寝てる間に移行して翌日から新しいマシン」ってわけにいかなくなるので、作業がひと段落ついたところで移行しようと思ってズルズル先延ばしに
    - 試したことがうまくいかなくて手戻りしたりしているうちに訳がわからなくなった
- OneDrive経由で移行する方法をお勧めされたが謎のパーミッションエラーで失敗
    - これは謎ではなく.sshや.dockerなどに特殊なパーミッションのファイルがあるからでは説(現時点の仮説)

- 他にどのような方法でファイルを移動すれば良いか調べるところから
    - [Macでファイル共有を設定する - Apple サポート (日本)](https://support.apple.com/ja-jp/guide/mac-help/mh17131/mac)
    - これは旧マシンでSambaを立てて新マシンからコピーする方法
    - 一旦めちゃくちゃ長時間の見積もりのプログレスバーは表示されるけど現実的な速度で移行できそう
        - 実験: 36000ファイル8GBをコピーしてみる
            - 予想終了時間は6時間後(最初は2時間の表示で、書いてる間に7時間に増えた)
            - 寝てる間に終わるか、それとも所要時間がどんどん伸びていって朝起きても終わってないか、を気にしていたが、なんと1時間で終わった
            - プログレスバーが過大申告してくるパターン！

- そもそもFinderから対象ファイルを選択してコピーするとき、ドットで始まるフォルダやファイルはコピーされているのか？
    - A: 簡潔に言えば、コピーはされるが選択はされない
        - デフォルトでは非表示になっている
            - Cmd+Shift+.で表示切り替え
        - なので「フォルダの中身全部を選択してコピー」した場合、ドットで始まるものは選択されてないのでコピーされない
        - フォルダAをコピーした場合にフォルダAの下のA/.gitignoreなどはコピーされている

ターミナルの設定は当然新しいマシンでは消し飛んでいる
- 古いマシンから設定を持って来れるか調べたけど移行ツールなしでどうやって移行するのかわからないから諦めて設定し直すことにしよう。

久しぶりなので何が必要か完全に忘れている
- 4年前と3年前の自分が記録してた！
    - [[Mac日記2018]]
    - [[Mac日記2019]]

実験的にいくつかのプロジェクトをコピーした
- 特に問題なくコピーできた
- 問題なく開発を継続できるかのテストが必要

2023-11-15
- 今日の夜はDropbox以外全部をまとめてコピーをかけて寝る
    - 何時間も掛かるだろうから
    - とりあえず今の理解によればエラーが起きないと思われる(.sshや.dockerは選択されてないので)
2023-11-16
- ![image](https://gyazo.com/263a8a284a35a1e37fc1e9979b95215b/thumb/1000)
- ダメだった

[http://scorpionfish.blog.shinobi.jp/ubuntu/sambaでmacのファイルが”%20一部の項目へのアクセス権がないため%E3%80%81操作は完了できません%E3%80%82”](http://scorpionfish.blog.shinobi.jp/ubuntu/sambaでmacのファイルが”%20一部の項目へのアクセス権がないため%E3%80%81操作は完了できません%E3%80%82”)
> Macのターミナルにてパーミッションを確認する。 読み書き可能となっているが、パーミッションの最後に"@"が付いているファイルがある。
> EA (Extended Attributes)と言う、付加情報。..Mac OS Xのバージョンアップ（現在10.6.3)に起因

>  この付加情報は、以下の方法で消すことができる。
>  $ xattr -d com.apple.FinderInfo "14 Amazing Grace.m4a"

>  今のところの解決方法。
>  ①xattr -d にてEAを消す。　　（面倒くさい）
>  ②USBや外付けHDDで移す。　　　（面倒くさい、サーバー作った意味ないし～。）
>  ③Samba以外の方法でファイルサーバーを作る。　　（netatalkを使う。 2.1以上はEAに対応している。でも大変そう）
>  ④Sambaが対応してくれるのを待つ。　　（祈る）
>
>  頑張って、netatalkをインストールすることにした。

どんなものに拡張属性がついてるのか確認したが.DS_Storeやスクリーンショットなど色々なものに付いている
- ついていたら必ず失敗するというわけでもなさそうだ

ネクストアクション
- コマンドラインでコピーして、何が問題の原因なのか特定する


---
2022-11-20
- 疲れからか立て続けにパスワードを間違えて旧マシンがロックされてしまった
    - ロック解除の相談を情シスとやりとりしつつ、並行して新マシンをセットアップ
    - →11/22 移行時のこちら側のミスによりリモートロック解除ができない状態と判明
- Chrome
    - インストールした
- Mattermost
    - サーバの情報をメモしてなかった、Chromeの履歴が覚えていた、メモした
- Zoom
    - 会議に入ることはできた
    - 会社のアカウントでSSOできるかはまだ

解決すべき問題
- 親指シフトで日本語入力ができない
- Chromeがジェスチャーで戻る、止めたい
    - ![image](https://gyazo.com/4e7ded581d7f4a04cb4661a099af1eab/thumb/1000)
- 会社のグループウェアにアクセスするための証明書が必要

2022-11-22
- Slack
    - [[Slackのシングルチャンネルゲスト難しすぎ]]

キーリピートを最速にする
before / after
![image](https://gyazo.com/285c40ef9203418a136d6a60aa7bc83c/thumb/1000)![image](https://gyazo.com/fe8e597233bc61dfe89d1c66e2a0f4f8/thumb/1000)

[[Cmd+Shift+4でクリップボードに入るようにする]]

親指シフトで日本語入力できるようにする
- [[Macで親指シフト日記2020-01]]
- 2021 [/shiology/06161 Karabiner-Elementsのみで親指シフト「shioシフト」を実現する設定が完成したのでシンプルな設定手順を公開します](https://scrapbox.io/shiology/06161 Karabiner-Elementsのみで親指シフト「shioシフト」を実現する設定が完成したのでシンプルな設定手順を公開します)
- [/shio/新しいMacで起案するための4つの設定と1つの訓練](https://scrapbox.io/shio/新しいMacで起案するための4つの設定と1つの訓練)
- なるほど Lacailleはもう使わなくて良いのか

![image](https://gyazo.com/334b81482dbad0960bd003cb9eb9685e/thumb/1000)
うしてけせはときいん
ここからが問題だ（これはshio-shiftで書いてる）
日本語を書く上ではshio-shiftでまったく問題ないのだが、僕はプログラマである関係上。日本語を主に書く人が使わないような記号をたくさん入力する
- shio-shift(とそのベースのorz配列)を尊重しつつ記号を使いやすいところにリマップすることも試みたが…
- 結局「日本語を書いている時とプログラミングをしている時は心の状態が別物だから配列も別物でよい」という結論になった
    - もともとプログラミング中にはコメントもコミットメントも英語で書く派だったので、プログラミング中に日本語入力用の配列にするメリットがない

実装すべきコードの予想はついてきたけど、それ過去の自分実装してないのかな、という気が…
あった
- from [/nishio/親指シフト日記](https://scrapbox.io/nishio/親指シフト日記)
    - 2018年8月
        - [[Macで親指シフト日記201808]]
        - LacailleとKarabiner-elementsを重ねる構造がエンジニア的に気持ち悪い
        - Karabiner-elementsだけで親指シフトが実現できる
        - Karabinerの設定ファイルを直接いじるのは辛い
        - 設定ファイルを生成するスクリプトをつくった
            - [[generate_karabiner_conf]]

ソースを読むとわかるけど、JSON出力時に「日本語モードがオンであること」と「ログインダイアログでないこと」を条件に加えている

[[VSCode]]

git
- ![image](https://gyazo.com/2dc9c04f94b61e4ecfa492d17c9241c4/thumb/1000)
    - へー、今のMacはこんなこと言うんだ
- ![image](https://gyazo.com/3f7a90a5d658218a4fc293c895092164/thumb/1000)
    - マジかよ
        - →1時間くらいで終わった

Dropboxのインストール→デフォルトをオンラインにして必要なものだけオフラインモードにする

今更気づいたんだけど日本語が入力できないからスマホを使ってるせいで見通しが悪くなってて
PCではHandoffの設定がおかしいせいでタブがChromeで開かれてたりSafariで開かれてたりして迷子になってるのだ
やっと混乱の理由がわかってきた
[[HandoffをSafariではなくChromeで開きたい]]
[[MacBookの仮想デスクトップの並び順を自由に固定したい]]

リポジトリに生成済みのファイルも入っていたけど、これをどうやって使うんだっけ…
Karabiner-ElementsのComplex Modificationsの使い方
- > 独自ルールは.json拡張子で保存して、下記フォルダ内に配置します。
- >  /Users/ユーザ名/.config/karabiner/assets/complex_modifications
    - [Karabiner-Elementsの独自ルールの作成方法 – Webrandum](https://webrandum.net/karabiner-elements-original-rules/)
- Official Document: [Use more complex rules | Karabiner-Elements](https://karabiner-elements.pqrs.org/docs/manual/configuration/configure-complex-modifications/)


:

```
!@#$%^&*()_+
1234567890-=
qwertyuiop[]
asdfghjkl;'\
zxcvbnm,./
```

うーん、右手のずらしは無くなったけど記号が正しくないな
これは元データ自体がおかしいのか？それともkarabinerの設定が間違ってるのか？？

[Macでjisキーボードなのにusキーボードとして認識されてしまう場合の直し方 | unlogue-アンローグ-](https://www.unlogue.com/mac-jis-us/)
- > 「環境設定」→「キーボード」→「入力ソース」の画面を確認してみましょう。
    - ![image](https://gyazo.com/83b99273d054648dd0e7d72df8405ca6/thumb/1000)
    - 確かに実際のキーボードと違う表示
- > 「Apple Internal Keyboard/Trackpad」にチェックが入っている場合は外してください。
    - ![image](https://gyazo.com/ac2dc0bdf2555c2aea7c3990ee720496/thumb/1000)
        - 外した
    - ![image](https://gyazo.com/3cb53c08bb29ec422ee5a3605dfbedc2/thumb/1000)
        - 直った！

        - いや全然ダメだ
            - Modify Eventをオフにしたら日本語の時の親指シフトの変換もオフになってなんの意味もない

[[バックスラッシュで円記号が入る]]
[[Macのセットアップメモ]]

2022-11-25
- [Karabiner-ElementsでJISキーボードがUSキーボードとして認識される問題 - Qiita](https://qiita.com/kenmaz/items/0ff152af776a3e6e5f6e)
    - > Karabiner-Elements Preferences を開いて、Virtual Keyboard
- ![image](https://gyazo.com/f2a6e4299059e7709575a38e77b14f85/thumb/1000)
- ![image](https://gyazo.com/7fd391530d59d62650ad45370c411250/thumb/1000)
- うしてけせはときいん
- @:*`;+
- OK!!


Mission ControlのCtrl矢印ショートカットを消す

qかたこさyらちくつほ「
うしてけせhはときいん」
ねひすふへnめそ、。＿
[[Macで親指シフト日記2020-01#5e00e8f5aff09e00000e2fb5]]
> 実際に入力してみて二重括弧とアスタリスクが出ておらず、全角スラッシュと中黒がおかしいことに気づいた
> ![image](https://gyazo.com/afe02f6951348d9c024cad6f94fb1574/thumb/1000)
うーん、これ、前回どこのレイヤーで変えたんだっけな？？
- [[generate_karabiner_conf]]の
    - [https://github.com/nishio/generate_karabiner_conf/blob/master/nishioshift/SPECIAL.txt](https://github.com/nishio/generate_karabiner_conf/blob/master/nishioshift/SPECIAL.txt)
    - これで変えることにした
    - コロンとかアンダースコアとか円記号とかは、この時点では書いてたけどその後まったく使わなくて覚えてなかったのでパス
    - エクスクラメーションと右下の中黒と中央のシフトなしでの鉤括弧を追加
    - [https://github.com/nishio/generate_karabiner_conf/commit/f1a52b08bd5760a0424e61c070620b4a08c3dd3d](https://github.com/nishio/generate_karabiner_conf/commit/f1a52b08bd5760a0424e61c070620b4a08c3dd3d)


[[デフォルトエディタがvi→VSCodeにする]]

2022-12-04
- [[ipythonのインストール]]
- Adobe XD入れる
    - ライセンス管理とかどうなってるのかなーと思ったがインストーラがブラウザのタブを開いて認証して「すでに2台のマシンでログインされてるからどっちかをログアウトしてね」と聞いてきた、簡単

2022-12-19
- [The Missing Package Manager for macOS (or Linux) — Homebrew](https://brew.sh/)
- `$ brew install ffmpeg`
- [[Whisper]]

2023-01-11
- [[Kozanebaの開発環境を作る]]

2023-01-16 [[VSCode]] 保存時オートフォーマットの設定を忘れてた
- 2023-01-26 [[Prettier]]を入れてdefault formatterの設定をする
    - [vscode settings - VS-Code Prettier Format On Save doesn't work - Stack Overflow](https://stackoverflow.com/questions/59433286/vs-code-prettier-format-on-save-doesnt-work)

2023-01-17 旧マシンサルベージ
> 2022/12/9
>  マシンA→マシンB→マシンCと移行してる最中にマシンBがロックされてしまった
>  マシンA→マシンBの移行が不適切だったためマシンBのリモートロック解除ができない
>
>  であればマシンBのロック解除ができるのか出荷時の状態に戻すことになるのか不明な現状だと
>  まずは「ネクストアクション:マシンAからデータをサルベージする」がよさそうですかね。
>  来週の金曜日までドタバタしているのでその後確認してみます

マシンAを起動しようとして、間違えてマシンBを起動したらログインできた(えっ)
- ロックが時間経過で解除された？？
- バッテリー完全枯渇からの再起動でなんらかの状態がリセットされた？

時間経過での画面ロックからの再ログインでFinger IDを使ったところ謎のハングアップ
- ログイン処理が進まない
- キャンセルはできる
> キャンセルしてパスワードを入れてログインしようとしたところ「アカウントはロックされています」になりました。
> ロックが解除される条件が時間経過なのかバッテリー枯渇からの再起動なのかわかりませんが、後者を試してみたいと思います。画面ロックからの復帰でもパスワードを入れれば大丈夫な可能性がありますし。

ネクストアクション
- マシンBをバッテリー完全放電まで放置
    - ログイン画面ではすぐスリープに入ってしまうのでバッテリーを消費させるのが難しいなぁ…
    - とりあえず明日まで放置
        - 明日確認して、バッテリーがあまり減ってないようだったら別の方法を考える
- 再起動してパスワードを入力してログイン
    - パスワードがマシンAからパスワードポリシーの変化の影響で違うものになっているので注意
- マシンCからSambaで接続
    - プロジェクトフォルダを更新日時の新しい方からコピー
- 並行して下記を試す
    - 非操作時のロック時間を解除または長い時間にできないか？
    - Finger IDをオフにできないか？

2023/1/23
- バッテリーは12%残ってたけどログインできた
    - 時間経過によるロック解除？
        - ![image](https://gyazo.com/da550b7f8a63b15e7fa2f0ec880fb682/thumb/1000)
        - この表示はおかしいのでは
            - 17日から6日間電源オフで放置してたのに今朝の3時まで電源オンだったみたいな表示になってる
            - バッテリーが12%残ってたという表示がおかしくて一旦空っぽになって、さらに表示がおかしくなった？
            - いや、でも完全放電からって感じではないスピーディな起動だったな…
                - ACを繋ぐ前に起動して確認するべきだったな

- Samba接続ができない
    - 前回できたのになぜ？

- ![image](https://gyazo.com/4f5e471ed3e0553e151c0df2631e218b/thumb/1000)
    - Macのロック解除にFinger IDを使わないようにすることはできた
    - パスワードの自動入力もOFFにしようとしたらパスワードを要求される
    - ここにパスワードを入れるとリジェクトされる
        - そのパスワードでログインできてるのに、なぜ？？
        - 何か認証周りでおかしなことになってる気配…

- Samba接続ができない件
    - パスワードを入れるとリジェクトされる / そのパスワードでログインできてるのに、なぜ？？
    - ゲストに読み出しアクセスを許可してゲストでの接続を試みる
        - ![image](https://gyazo.com/7c49a002ea7836f3e67ee2bc346241ea/thumb/1000)
        - うーん
- MSアカウントにログインしてOneDriveに流し込むチャレンジ
    - 終了時間の見積もりとか出さないのね
    - ![image](https://gyazo.com/947971c55646b59549f6515980e76df6/thumb/1000)
    - この件に関してはnode_modulesの中だったので丸ごと消すことにした

とりあえずしばらく放置して同期がどうなったかを確認かな



2023-01-26
- Gyazo GIF
- ![image](https://gyazo.com/85e7ec00fe78b34d3fc2eefc5893e678/thumb/1000)

ローカルの開発環境の設定が何かおかしくてローカルでは警告されなくてスルーしたものが本番環境のビルドでフェイルしてた
- そういうの面倒だからローカルの警告を厳しくしたい
- eslintを開発環境に入れ忘れてるのか？
- VSCode拡張、ESLintとPrettier ESLintとあるな、どっちだろ
- 前者を入れたらちゃんと警告されるようになった

2023-02-01
[[Docker for Mac]]
- ![image](https://gyazo.com/a400c59b94f172c3a78a7c4a5ae0cb3a/thumb/1000)
- ![image](https://gyazo.com/2cbb5f581b6849a58f0b38587cefedba/thumb/1000)
    - トップページからダウンロードしたのだがよく見たらIntel Chipと書いてあった
